colnames(s_ari_f1) <- paste0("s", 1:4)
s_ari_f1 <- data.frame(
"metric" = c("full1_ARI", "tail2_ARI", "full1_F1", "tail2_ARI"),
s_ari_f1
)
s_ari_f1$s1
s_ari_f1
library(mvtnorm)
qqmvn <- function(y, CI = TRUE, ci_lty = 2, ci_lwd = 2, ci_col = 2, line_col = 1, line_lwd = 1, line_lty =1, xlab = "Theoretical Quantiles", ylab = "Sample Quantiles", ...){
n <- nrow(y)
p <- ncol(y)
ybar <- colMeans(y)
S <- cov(y)
c1 <- p/2*log(2*pi) + 0.5*log(det(S))
md1 <- apply(y, 1, mvtnorm::dmvnorm, mean = ybar, sigma = S, log = TRUE)
md1 <- -2*(md1 + c1)
qp <- qbeta(ppoints(n), p/2, (n -p -1)/2)
sm <- md1*n/(n-1)^2
plot(qp, sort(sm), xlab = xlab, ylab = ylab, ...)
abline(0, 1, col = line_col, lwd = line_lwd, lty = line_lty)
if(CI){
rbmat <- replicate(1000, sort(rbeta(n, p/2, (n -p -1)/2)))
rbci <- apply(rbmat, 1, quantile, probs = c(0.025, 0.975))
lines(qbeta(ppoints(n), p/2, (n -p -1)/2), rbci[1, ], col = ci_col, lwd = ci_lwd, lty = ci_lty)
lines(qbeta(ppoints(n), p/2, (n -p -1)/2), rbci[2, ], col = ci_col, lwd = ci_lwd, lty = ci_lty)
}
}
qqmvn(noisy_s4)
qqmvn(noisy_s1)
noisy_s1 <- read.table(paste0(folder, "/noisy/noisy_s1.txt"))
qqmvn(noisy_s1)
qqmvn(noisy_s1[!ombc_update1e4_noisy_s1$gross_outs, ])
s_ari_f1 <- round(rbind(
"full1_num" = c(
ombc_update1e4_noisy_s1$outlier_num["full"],
ombc_update1e4_noisy_s2$outlier_num["full"],
ombc_update1e4_noisy_s3$outlier_num["full"],
ombc_update1e4_noisy_s4$outlier_num["full"]
),
"tail2_num" = c(
ombc_update1e4reuse0_noisy_s1$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s2$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s3$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s4$outlier_num["tail"]
),
"full1_ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4_noisy_s1$labels$full),
mixture::ARI(noisy_s2_label, ombc_update1e4_noisy_s2$labels$full),
mixture::ARI(noisy_s3_label, ombc_update1e4_noisy_s3$labels$full),
mixture::ARI(noisy_s4_label, ombc_update1e4_noisy_s4$labels$full)
),
"tail2_ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4reuse0_noisy_s1$labels$tail),
mixture::ARI(noisy_s2_label, ombc_update1e4reuse0_noisy_s2$labels$tail),
mixture::ARI(noisy_s3_label, ombc_update1e4reuse0_noisy_s3$labels$tail),
mixture::ARI(noisy_s4_label, ombc_update1e4reuse0_noisy_s4$labels$tail)
),
"full1_F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4_noisy_s1$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4_noisy_s2$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4_noisy_s3$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4_noisy_s4$outlier_bool$full)$f1_vec)
),
"full1_F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4reuse0_noisy_s1$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4reuse0_noisy_s2$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4reuse0_noisy_s3$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4reuse0_noisy_s4$outlier_bool$tail)$f1_vec)
)
), 2)
colnames(s_ari_f1) <- paste0("s", 1:4)
s_ari_f1
s_ari_f1_mat <- rbind(
"full1_num" = c(
ombc_update1e4_noisy_s1$outlier_num["full"],
ombc_update1e4_noisy_s2$outlier_num["full"],
ombc_update1e4_noisy_s3$outlier_num["full"],
ombc_update1e4_noisy_s4$outlier_num["full"]
),
"tail2_num" = c(
ombc_update1e4reuse0_noisy_s1$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s2$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s3$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s4$outlier_num["tail"]
),
"full1_ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4_noisy_s1$labels$full),
mixture::ARI(noisy_s2_label, ombc_update1e4_noisy_s2$labels$full),
mixture::ARI(noisy_s3_label, ombc_update1e4_noisy_s3$labels$full),
mixture::ARI(noisy_s4_label, ombc_update1e4_noisy_s4$labels$full)
),
"tail2_ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4reuse0_noisy_s1$labels$tail),
mixture::ARI(noisy_s2_label, ombc_update1e4reuse0_noisy_s2$labels$tail),
mixture::ARI(noisy_s3_label, ombc_update1e4reuse0_noisy_s3$labels$tail),
mixture::ARI(noisy_s4_label, ombc_update1e4reuse0_noisy_s4$labels$tail)
),
"full1_F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4_noisy_s1$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4_noisy_s2$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4_noisy_s3$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4_noisy_s4$outlier_bool$full)$f1_vec)
),
"full1_F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4reuse0_noisy_s1$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4reuse0_noisy_s2$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4reuse0_noisy_s3$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4reuse0_noisy_s4$outlier_bool$tail)$f1_vec)
)
)
s_ari_f1 <- as_tibble(s_ari_f1)
s_ari_f1
s_ari_f1_mat <- cbind(
"full1_num" = c(
ombc_update1e4_noisy_s1$outlier_num["full"],
ombc_update1e4_noisy_s2$outlier_num["full"],
ombc_update1e4_noisy_s3$outlier_num["full"],
ombc_update1e4_noisy_s4$outlier_num["full"]
),
"tail2_num" = c(
ombc_update1e4reuse0_noisy_s1$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s2$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s3$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s4$outlier_num["tail"]
),
"full1_ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4_noisy_s1$labels$full),
mixture::ARI(noisy_s2_label, ombc_update1e4_noisy_s2$labels$full),
mixture::ARI(noisy_s3_label, ombc_update1e4_noisy_s3$labels$full),
mixture::ARI(noisy_s4_label, ombc_update1e4_noisy_s4$labels$full)
),
"tail2_ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4reuse0_noisy_s1$labels$tail),
mixture::ARI(noisy_s2_label, ombc_update1e4reuse0_noisy_s2$labels$tail),
mixture::ARI(noisy_s3_label, ombc_update1e4reuse0_noisy_s3$labels$tail),
mixture::ARI(noisy_s4_label, ombc_update1e4reuse0_noisy_s4$labels$tail)
),
"full1_F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4_noisy_s1$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4_noisy_s2$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4_noisy_s3$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4_noisy_s4$outlier_bool$full)$f1_vec)
),
"full1_F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4reuse0_noisy_s1$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4reuse0_noisy_s2$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4reuse0_noisy_s3$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4reuse0_noisy_s4$outlier_bool$tail)$f1_vec)
)
)
colnames(s_ari_f1_mat) <- paste0("s", 1:4)
s_ari_f1_mat
s_ari_f1 <- as_tibble(paste0("s", 1:4), s_ari_f1)
s_ari_f1 <- as_tibble("dataset" = paste0("s", 1:4), s_ari_f1)
s_ari_f1
s_ari_f1 <- tibble("dataset" = paste0("s", 1:4), s_ari_f1)
s_ari_f1_mat <- cbind(
"full1_num" = c(
ombc_update1e4_noisy_s1$outlier_num["full"],
ombc_update1e4_noisy_s2$outlier_num["full"],
ombc_update1e4_noisy_s3$outlier_num["full"],
ombc_update1e4_noisy_s4$outlier_num["full"]
),
"tail2_num" = c(
ombc_update1e4reuse0_noisy_s1$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s2$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s3$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s4$outlier_num["tail"]
),
"full1_ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4_noisy_s1$labels$full),
mixture::ARI(noisy_s2_label, ombc_update1e4_noisy_s2$labels$full),
mixture::ARI(noisy_s3_label, ombc_update1e4_noisy_s3$labels$full),
mixture::ARI(noisy_s4_label, ombc_update1e4_noisy_s4$labels$full)
),
"tail2_ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4reuse0_noisy_s1$labels$tail),
mixture::ARI(noisy_s2_label, ombc_update1e4reuse0_noisy_s2$labels$tail),
mixture::ARI(noisy_s3_label, ombc_update1e4reuse0_noisy_s3$labels$tail),
mixture::ARI(noisy_s4_label, ombc_update1e4reuse0_noisy_s4$labels$tail)
),
"full1_F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4_noisy_s1$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4_noisy_s2$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4_noisy_s3$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4_noisy_s4$outlier_bool$full)$f1_vec)
),
"full1_F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4reuse0_noisy_s1$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4reuse0_noisy_s2$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4reuse0_noisy_s3$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4reuse0_noisy_s4$outlier_bool$tail)$f1_vec)
)
)
s_ari_f1 <- tibble("dataset" = paste0("s", 1:4), s_ari_f1_mat)
s_ari_f1
s_ari_f1 <- tibble(s_ari_f1_mat) |> mutate("dataset" = paste0("s", 1:4))
s_ari_f1
s_ari_f1 <- tibble(s_ari_f1_mat) |> mutate("dataset" = paste0("s", 1:4), .before = s1)
s_ari_f1 <- tibble(s_ari_f1_mat) |> mutate("dataset" = paste0("s", 1:4), .before = full1_ARI)
tibble(s_ari_f1_mat)
s_ari_f1 <- as_tibble(s_ari_f1_mat) |> mutate("dataset" = paste0("s", 1:4), .before = full1_ARI)
as_tibble(s_ari_f1_mat)
s_ari_f1_mat <- cbind(
"full1_num" = c(
ombc_update1e4_noisy_s1$outlier_num["full"],
ombc_update1e4_noisy_s2$outlier_num["full"],
ombc_update1e4_noisy_s3$outlier_num["full"],
ombc_update1e4_noisy_s4$outlier_num["full"]
),
"tail2_num" = c(
ombc_update1e4reuse0_noisy_s1$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s2$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s3$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s4$outlier_num["tail"]
),
"full1_ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4_noisy_s1$labels$full),
mixture::ARI(noisy_s2_label, ombc_update1e4_noisy_s2$labels$full),
mixture::ARI(noisy_s3_label, ombc_update1e4_noisy_s3$labels$full),
mixture::ARI(noisy_s4_label, ombc_update1e4_noisy_s4$labels$full)
),
"tail2_ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4reuse0_noisy_s1$labels$tail),
mixture::ARI(noisy_s2_label, ombc_update1e4reuse0_noisy_s2$labels$tail),
mixture::ARI(noisy_s3_label, ombc_update1e4reuse0_noisy_s3$labels$tail),
mixture::ARI(noisy_s4_label, ombc_update1e4reuse0_noisy_s4$labels$tail)
),
"full1_F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4_noisy_s1$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4_noisy_s2$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4_noisy_s3$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4_noisy_s4$outlier_bool$full)$f1_vec)
),
"tail2_F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4reuse0_noisy_s1$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4reuse0_noisy_s2$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4reuse0_noisy_s3$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4reuse0_noisy_s4$outlier_bool$tail)$f1_vec)
)
)
s_ari_f1 <- as_tibble(s_ari_f1_mat) |> mutate("dataset" = paste0("s", 1:4), .before = full1_ARI)
s_ari_f1
s_ari_f1 <- as_tibble(s_ari_f1_mat) |> mutate("dataset" = paste0("s", 1:4), .before = full1_num)
s_ari_f1
s_full1_mat <- cbind(
"outnum" = c(
ombc_update1e4_noisy_s1$outlier_num["full"],
ombc_update1e4_noisy_s2$outlier_num["full"],
ombc_update1e4_noisy_s3$outlier_num["full"],
ombc_update1e4_noisy_s4$outlier_num["full"]
),
"ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4_noisy_s1$labels$full),
mixture::ARI(noisy_s2_label, ombc_update1e4_noisy_s2$labels$full),
mixture::ARI(noisy_s3_label, ombc_update1e4_noisy_s3$labels$full),
mixture::ARI(noisy_s4_label, ombc_update1e4_noisy_s4$labels$full)
),
"F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4_noisy_s1$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4_noisy_s2$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4_noisy_s3$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4_noisy_s4$outlier_bool$full)$f1_vec)
)
)
s_full1_mat <- cbind(
"outnum" = c(
ombc_update1e4_noisy_s1$outlier_num["full"],
ombc_update1e4_noisy_s2$outlier_num["full"],
ombc_update1e4_noisy_s3$outlier_num["full"],
ombc_update1e4_noisy_s4$outlier_num["full"]
),
"ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4_noisy_s1$labels$full),
mixture::ARI(noisy_s2_label, ombc_update1e4_noisy_s2$labels$full),
mixture::ARI(noisy_s3_label, ombc_update1e4_noisy_s3$labels$full),
mixture::ARI(noisy_s4_label, ombc_update1e4_noisy_s4$labels$full)
),
"F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4_noisy_s1$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4_noisy_s2$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4_noisy_s3$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4_noisy_s4$outlier_bool$full)$f1_vec)
)
)
s_full1 <- as_tibble(s_full1_mat) |> mutate("dataset" = paste0("s", 1:4), .before = outnum)
s_full1
s_tail1_mat <- cbind(
"outnum" = c(
ombc_update1e4_noisy_s1$outlier_num["tail"],
ombc_update1e4_noisy_s2$outlier_num["tail"],
ombc_update1e4_noisy_s3$outlier_num["tail"],
ombc_update1e4_noisy_s4$outlier_num["tail"]
),
"ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4_noisy_s1$labels$tail),
mixture::ARI(noisy_s2_label, ombc_update1e4_noisy_s2$labels$tail),
mixture::ARI(noisy_s3_label, ombc_update1e4_noisy_s3$labels$tail),
mixture::ARI(noisy_s4_label, ombc_update1e4_noisy_s4$labels$tail)
),
"F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4_noisy_s1$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4_noisy_s2$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4_noisy_s3$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4_noisy_s4$outlier_bool$tail)$f1_vec)
)
)
s_tail1 <- as_tibble(s_tail1_mat) |> mutate("dataset" = paste0("s", 1:4), .before = outnum)
s_tail1
plot_tail_curve(ombc_update1e4_noisy_s3)
plot_tail_curve(ombc_update1e4reuse0_noisy_s3)
noisy_s3 <- read.table(paste0(folder, "/noisy/noisy_s3.txt"))
s_tail2_mat <- cbind(
"outnum" = c(
ombc_update1e4reuse0_noisy_s1$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s2$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s3$outlier_num["tail"],
ombc_update1e4reuse0_noisy_s4$outlier_num["tail"]
),
"ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4reuse0_noisy_s1$labels$tail),
mixture::ARI(noisy_s2_label, ombc_update1e4reuse0_noisy_s2$labels$tail),
mixture::ARI(noisy_s3_label, ombc_update1e4reuse0_noisy_s3$labels$tail),
mixture::ARI(noisy_s4_label, ombc_update1e4reuse0_noisy_s4$labels$tail)
),
"F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4reuse0_noisy_s1$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4reuse0_noisy_s2$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4reuse0_noisy_s3$outlier_bool$tail)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4reuse0_noisy_s4$outlier_bool$tail)$f1_vec)
)
)
s_tail2 <- as_tibble(s_tail2_mat) |> mutate("dataset" = paste0("s", 1:4), .before = outnum)
s_tail2
sum(ombc_update1e4_noisy_s4$quick_tail)
sum(ombc_update1e4_noisy_s4$quick_tail) + sum(ombc_update1e4_noisy_s4$gross_outs)
sum(ombc_update1e4_noisy_s3$quick_tail) + sum(ombc_update1e4_noisy_s3$gross_outs)
ombc_update1e4_noisy_s3$outlier_num
sum(ombc_update1e4_noisy_s2$quick_tail) + sum(ombc_update1e4_noisy_s2$gross_outs)
ombc_update1e4_noisy_s3$outlier_num
ombc_update1e4_noisy_s2$outlier_num
sum(ombc_update1e4_noisy_s1$quick_tail) + sum(ombc_update1e4_noisy_s1$gross_outs)
ombc_update1e4_noisy_s1$outlier_num
s_full2_mat <- cbind(
"outnum" = c(
ombc_update1e4reuse0_noisy_s1$outlier_num["full"],
ombc_update1e4reuse0_noisy_s2$outlier_num["full"],
ombc_update1e4reuse0_noisy_s3$outlier_num["full"],
ombc_update1e4reuse0_noisy_s4$outlier_num["full"]
),
"ARI" = c(
mixture::ARI(noisy_s1_label, ombc_update1e4reuse0_noisy_s1$labels$full),
mixture::ARI(noisy_s2_label, ombc_update1e4reuse0_noisy_s2$labels$full),
mixture::ARI(noisy_s3_label, ombc_update1e4reuse0_noisy_s3$labels$full),
mixture::ARI(noisy_s4_label, ombc_update1e4reuse0_noisy_s4$labels$full)
),
"F1" = c(
mean(gateTree::get_f1(noisy_s1_label == 0, ombc_update1e4reuse0_noisy_s1$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s2_label == 0, ombc_update1e4reuse0_noisy_s2$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s3_label == 0, ombc_update1e4reuse0_noisy_s3$outlier_bool$full)$f1_vec),
mean(gateTree::get_f1(noisy_s4_label == 0, ombc_update1e4reuse0_noisy_s4$outlier_bool$full)$f1_vec)
)
)
s_full2 <- as_tibble(s_full2_mat) |> mutate("dataset" = paste0("s", 1:4), .before = outnum)
s_full2
s_full1
s_full1
s_full2
s_tail1
s_tail2
noisy_s3_label[ombc_update1e4reuse0_noisy_s3$outlier_rank]
table(ombc_update1e4reuse0_noisy_s3$outlier_rank)
noisy_s3_label[order(ombc_update1e4reuse0_noisy_s3$outlier_rank)]
noisy_s3_label[order(ombc_update1e4reuse0_noisy_s3$outlier_rank)][4500:5000]
sum(ombc_update1e4_noisy_s3$gross_outs)
5350-232
table(noisy_s3_label[ombc_update1e4_noisy_s3$gross_outs])
cbind(ombc_update1e4reuse0_noisy_s3$outlier_rank, noisy_s3_label)
cbind(ombc_update1e4reuse0_noisy_s3$outlier_rank, noisy_s3_label)[order(ombc_update1e4reuse0_noisy_s3$outlier_rank)]
cbind(ombc_update1e4reuse0_noisy_s3$outlier_rank, noisy_s3_label)[order(ombc_update1e4reuse0_noisy_s3$outlier_rank), ]
cbind(ombc_update1e4reuse0_noisy_s3$outlier_rank, noisy_s3_label)[order(ombc_update1e4reuse0_noisy_s3$outlier_rank), ][ombc_update1e4reuse0_noisy_s3$outlier_rank != 0, ]
cbind(ombc_update1e4reuse0_noisy_s3$outlier_rank, noisy_s3_label)[ombc_update1e4reuse0_noisy_s3$outlier_rank != 0, ][order(ombc_update1e4reuse0_noisy_s3$outlier_rank[ombc_update1e4reuse0_noisy_s3$outlier_rank != 0]), ]
s_full1
s_full2
ombc_update1e4reuse0update1e4_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_update1e4reuse0update1e4_noisy_s4.rds")
plot_full_curve(ombc_update1e4reuse0update1e4_noisy_s4)
ombc_update1e4reuse0reuse0_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_update1e4reuse0reuse0_noisy_s4.rds")
plot_full_curve(ombc_update1e4reuse0reuse0_noisy_s4)
plot_tail_curve(ombc_update1e4reuse0reuse0_noisy_s4)
plot_tail_curve(ombc_update1e4reuse0_noisy_s4)
s_full1
s_full2
s_tail1
s_tail2
plot_tail_curve(ombc_update1e4_noisy_s1)
plot_tail_curve(ombc_update1e4_noisy_s2)
plot_tail_curve(ombc_update1e4_noisy_s3)
plot_tail_curve(ombc_update1e4_noisy_s4)
s_full1
s_tail1
plot_tail_curve(ombc_update1e4reuse0_noisy_s4)
plot_tail_curve(ombc_update1e4reuse0reuse0_noisy_s4)
plot_full_curve(ombc_update1e4reuse0_noisy_s4)
plot_full_curve(ombc_update1e4reuse0reuse0_noisy_s4)
ombc_update1e4reuse0reuse0_noisy_s3 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_update1e4reuse0reuse0_noisy_s3.rds")
plot_full_curve(ombc_update1e4_noisy_s3)
plot_full_curve(ombc_update1e4reuse0_noisy_s3)
plot_full_curve(ombc_update1e4reuse0reuse0_noisy_s3)
plot_tail_curve(ombc_update1e4_noisy_s3)
plot_tail_curve(ombc_update1e4reuse0_noisy_s3)
plot_tail_curve(ombc_update1e4reuse0reuse0_noisy_s3)
s_full2
s_tail2
plot_tail_curve(ombc_update1e4reuse0_noisy_s4)
plot_tail_curve(ombc_update1e4reuse0reuse0_noisy_s4)
plot_tail_curve(ombc_update1e4reuse0_noisy_s4)
plot_tail_curve(ombc_update1e4reuse0reuse0_noisy_s3)
plot(noisy_s3, col = ombc_update1e4reuse0_noisy_s3$labels$tail + 1)
plot(noisy_s3, col = ombc_update1e4reuse0_noisy_s3$labels$full + 1)
plot(noisy_s3, col = ombc_update1e4reuse0reuse0_noisy_s3$labels$tail + 1)
plot(noisy_s4, col = ombc_update1e4reuse0_noisy_s4$labels$tail + 1)
plot(noisy_s4, col = ombc_reinit_noisy_s4$labels$full + 1)
ombc_reinit1e4_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_reinit1e4_noisy_s4.rds")
plot_full_curve(ombc_reinit1e4_noisy_s4)
plot(noisy_s4, col = ombc_reinit1e4_noisy_s4$labels$full + 1)
ombc_reinit1e4_noisy_s4$loglike
ombc_reinit1e4_noisy_s4$mix$full$info_loglik
ombc_update1e4_noisy_s4$mix$full$info_loglik
ombc_update1e4_noisy_s4$mix$tail$info_loglik
plot_full_curve(ombc_reinit1e4_noisy_s4)
plot_full_curve(ombc_update1e4_noisy_s4)
ombc_choice1e4_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_choice1e4_noisy_s4.rds")
plot_full_curve(ombc_choice1e4_noisy_s4)
ombc_choice1e4_noisy_s4$mix$tail$info_loglik
which.min(ombc_choice1e4_noisy_s4$distrib_diff_mat[, "full"])
which.min(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"])
ombc_reinit1e4_noisy_s4$loglike[42]
ombc_update1e4_noisy_s4$loglike[42]
ombc_choice1e4_noisy_s4$loglike[42]
plot(log(ombc_update1e4_noisy_s4$loglike))
plot(-log(-ombc_update1e4_noisy_s4$loglike))
plot(ombc_update1e4_noisy_s4$loglike)
plot(lm(ombc_update1e4_noisy_s4$loglike))
lm(ombc_update1e4_noisy_s4$loglike)
lm(ombc_update1e4_noisy_s4$loglike ~ 0:250)
lm(ombc_update1e4_noisy_s4$loglike ~ c(0:250))
plot(lm(ombc_update1e4_noisy_s4$loglike ~ c(0:250)))
plot(ombc_update1e4_noisy_s4$loglike)
abline(lm(ombc_update1e4_noisy_s4$loglike ~ c(0:250)), col = "red")
s4_loglike_lm <- lm(ombc_update1e4_noisy_s4$loglike ~ c(0:250))
plot(s4_loglike_lm$residuals)
ombc_update1e4_noisy_s1$loglike - cumsum(ombc_update1e4_noisy_s1$removal_dens)
plot(ombc_update1e4_noisy_s1$loglike - cumsum(ombc_update1e4_noisy_s1$removal_dens))
lines(ombc_update1e4_noisy_s1$loglike)
cumsum(ombc_update1e4_noisy_s1$removal_dens)
plot(ombc_update1e4_noisy_s1$loglike - cumsum(log(ombc_update1e4_noisy_s1$removal_dens)))
lines(ombc_update1e4_noisy_s1$loglike)
lines(cumsum(log(ombc_choice1e4_noisy_s4$removal_dens))
cumsum(log(ombc_choice1e4_noisy_s4$removal_dens)
lines(cumsum(log(ombc_choice1e4_noisy_s4$removal_dens)))
cumsum(log(ombc_choice1e4_noisy_s4$removal_dens))
plot(ombc_update1e4_noisy_s1$loglike + cumsum(log(ombc_update1e4_noisy_s1$removal_dens)))
plot(ombc_update1e4_noisy_s1$loglike + cumsum(log(ombc_update1e4_noisy_s1$removal_dens)), type = ""l)
plot(ombc_update1e4_noisy_s1$loglike + cumsum(log(ombc_update1e4_noisy_s1$removal_dens)), type = "l")
plot(ombc_update1e4_noisy_s1$loglike + cumsum(log(ombc_update1e4_noisy_s1$removal_dens)), type = "l")
plot(ombc_update1e4_noisy_s2$loglike + cumsum(log(ombc_update1e4_noisy_s2$removal_dens)), type = "l")
plot(ombc_update1e4_noisy_s3$loglike + cumsum(log(ombc_update1e4_noisy_s3$removal_dens)), type = "l")
plot(ombc_update1e4_noisy_s4$loglike + cumsum(log(ombc_update1e4_noisy_s4$removal_dens)), type = "l")
abline(v = 5)
abline(v = 7)
plot(ombc_update1e4_noisy_s3$loglike + cumsum(log(ombc_update1e4_noisy_s3$removal_dens)), type = "l")
plot(ombc_update1e4_noisy_s2$loglike + cumsum(log(ombc_update1e4_noisy_s2$removal_dens)), type = "l")
plot(ombc_update1e4_noisy_s1$loglike + cumsum(log(ombc_update1e4_noisy_s1$removal_dens)), type = "l")
plot(noisy_s3, col = 1 + ombc_update1e4reuse0_noisy_s3$labels$full)
plot(ombc_update1e4_noisy_s4$loglike)
plot(ombc_reinit1e4_noisy_s4$loglike, col = "red")
plot(ombc_update1e4_noisy_s4$loglike, type = "b", pch = 20)
lines(ombc_reinit1e4_noisy_s4$loglike, type = "b", pch = 20)
lines(ombc_reinit1e4_noisy_s4$loglike, col = "red", pch = 20)
plot(ombc_update1e4_noisy_s4$loglike, type = "l", pch = 20)
lines(ombc_reinit1e4_noisy_s4$loglike, col = "red", pch = 20)
max(ombc_update1e4_noisy_s4$loglike / ombc_reinit1e4_noisy_s4$loglike)
min(ombc_update1e4_noisy_s4$loglike / ombc_reinit1e4_noisy_s4$loglike)
min(ombc_update1e4_noisy_s4$loglike / ombc_reinit1e4_noisy_s4$loglike) * 100
max(ombc_update1e4_noisy_s4$loglike / ombc_reinit1e4_noisy_s4$loglike) * 100
plot_full_curve(ombc_reinit1e4_noisy_s4)
max(ombc_update1e4_noisy_s4$loglike - ombc_reinit1e4_noisy_s4$loglike) * 100
max(ombc_update1e4_noisy_s4$loglike - ombc_reinit1e4_noisy_s4$loglike)
plot(ombc_update1e4_noisy_s4$loglike - ombc_reinit1e4_noisy_s4$loglike)
min(ombc_update1e4_noisy_s4$loglike - ombc_reinit1e4_noisy_s4$loglike)
lines(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"])
par(mfrow = c(2, 1))
plot(ombc_update1e4_noisy_s4$loglike - ombc_reinit1e4_noisy_s4$loglike)
plot(ombc_update1e4_noisy_s4$loglike - ombc_reinit1e4_noisy_s4$loglike)
plot(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"])
plot(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"], type = "l")
plot(ombc_update1e4_noisy_s4$loglike - ombc_reinit1e4_noisy_s4$loglike, type = "l")
plot(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"], type = "l")
plot(ombc_update1e4_noisy_s4$loglike - ombc_reinit1e4_noisy_s4$loglike, type = "l")
plot(ombc_update1e4_noisy_s4$loglike - ombc_reinit1e4_noisy_s4$loglike, type = "l")
plot(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"], type = "l")
plot(ombc_reinit1e4_noisy_s4$loglike)
plot(diff(ombc_reinit1e4_noisy_s4$loglike))
plot(diff(ombc_update1e4_noisy_s4$loglike))
min(diff(ombc_update1e4_noisy_s4$loglike))
min(diff(ombc_reinit1e4_noisy_s4$loglike))
load_all()
document()
library(devtools)
document()
check()
check()
