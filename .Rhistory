lympho1_gross <- find_gross(lympho1_trim, 400)
lympho1_gross$plot
lympho1_gross <- find_gross(lympho1_trim, 100)
lympho1_gross <- find_gross(lympho1_trim, 100)$plot
find_gross(lympho1_trim, 100)$plot
find_gross(lympho1_trim, 200)$plot
find_gross(lympho1_trim, 300)$plot
find_gross(lympho1_trim, 400)$plot
find_gross(lympho1_trim, 500)$plot
find_gross(lympho1_trim, 600)$plot
find_gross(lympho1_trim, 700)$plot
find_gross(lympho1_trim, 800)$plot
find_gross(lympho1_trim, 900)$plot
find_gross(lympho1_trim, 1000)$plot
find_gross(lympho1_trim, 100)$plot
find_gross(lympho1_trim, 200)$plot
find_gross(lympho1_trim, 300)$plot
find_gross(lympho1_trim, 400)$plot
find_gross(lympho1_trim, 500)$plot
find_gross(lympho1_trim, 600)$plot
find_gross(lympho1_trim, 700)$plot
find_gross(lympho1_trim, 800)$plot
find_gross(lympho1_trim, 900)$plot
find_gross(lympho1_trim, 1000)$plot
find_gross(lympho1_trim, 1100)$plot
find_gross(lympho1_trim, 1200)$plot
find_gross(lympho1_trim, 1300)$plot
find_gross(lympho1_trim, 1400)$plot
find_gross(lympho1_trim, 1500)$plot
find_gross(lympho1_trim, 1600)$plot
find_gross(lympho1_trim, 1700)$plot
find_gross(lympho1_trim, 400)$plot
lympho1_gross <- find_gross(lympho1_trim, 400)
lympho1_gross$plot
plot(lympho1_trim, col = lympho1_gross$bool + 1)
find_gross(lympho1_trim, 100)$plot
find_gross(lympho1_trim, 200)$plot
find_gross(lympho1_trim, 50)$plot
plot(lympho1_full_umap, main = "lympho1_full_umap")
plot(lympho1_trim_umap, main = "lympho1_trim_umap")
plot(lympho1_trim_umap[, 2:1], main = "lympho1_trim_umap")
plot(lympho1_full_umap, main = "lympho1_full_umap")
plot(lympho1_trim_umap[, 2:1], main = "lympho1_trim_umap")
plot(lympho1_full_umap, main = "lympho1_full_umap")
plot(
lympho1_trim_umap[, 1], lympho1_trim_umap[, 2], main = "lympho1_trim_umap"
)
plot(lympho1_full_umap, main = "lympho1_full_umap")
plot(
-lympho1_trim_umap[, 1], -lympho1_trim_umap[, 2], main = "lympho1_trim_umap"
)
plot(lympho1_full_umap, main = "lympho1_full_umap")
plot(
-lympho1_trim_umap[, 1], -lympho1_trim_umap[, 2], main = "lympho1_trim_umap"
)
plot(lympho1_full_umap, main = "lympho1_full_umap")
plot(-lympho1_trim_umap, main = "lympho1_trim_umap")
plot(lympho1_trim)
mclust::nMclustParams("VVV", 10, 3)
gmm_d4k3n4000o40 <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(c(-1, 0, 0, 0), c(+1, -1, 0, 0), c(+1, +1, 0, 0)),
sigma = list(
diag(c(0.2, 4 * 0.2, 0.2, 0.2)),
diag(c(0.2, 0.2, 0.2, 0.2)),
diag(c(0.2, 0.2, 0.2, 0.2))
),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
plot(gmm_d4k3n4000o40)
plot(gmm_d4k3n4000o40[, -5])
plot(gmm_d4k3n4000o40[, -5], col = gmm_d4k3n4000o40$G)
plot(gmm_d4k3n4000o40[, 1:4], col = gmm_d4k3n4000o40$G + 1)
ombc_d3k3n4000o40 <- ombc_gmm(
gmm_d4k3n4000o40, 3, 80, print_interval = 10
)
ombc_d3k3n4000o40 <- ombc_gmm(
gmm_d4k3n4000o40[, 1:4], 3, 80, print_interval = 10
)
ombc_d3k3n4000o40$plot_curves
gross_d3k3n4000o40 <- find_gross(
gmm_d4k3n4000o40[, 1:4], 80
)
gross_d3k3n4000o40$plot
gmm_d4k3n4000o40 <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(c(-1, 0, 0, 0), c(+1, -1, 0, 0), c(+1, +1, 0, 0)),
sigma = list(
diag(c(0.2, 4 * 0.2, 0.2, 0.2)),
diag(c(0.2, 0.2, 0.2, 0.2)),
diag(c(0.2, 0.2, 0.2, 0.2))
),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
plot(gmm_d4k3n4000o40[, 1:4], col = gmm_d4k3n4000o40$G + 1)
gross_d4k3n4000o40 <- find_gross(
gmm_d4k3n4000o40[, 1:4], 80
)
gross_d4k3n4000o40$plot
ombc_d4k3n4000o40 <- ombc_gmm(
gmm_d4k3n4000o40[, 1:4], 3, 80,
gross_outs = gross_d4k3n4000o40$bool,
print_interval = 10
)
ombc_d3k3n4000o40$plot_curves
ombc_d4k3n4000o40$plot_curves
gmm_d8k3n4000o40 <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(
c(-1, 0, 0, 0, 0, 0, 0, 0),
c(+1, -1, 0, 0, 0, 0, 0, 0),
c(+1, +1, 0, 0, 0, 0, 0, 0)),
sigma = list(
diag(c(0.2, 4 * 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2)),
diag(c(0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2)),
diag(c(0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2, 0.2))
),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
plot(gmm_d8k3n4000o40[, 1:4], col = gmm_d8k3n4000o40$G + 1)
plot(gmm_d8k3n4000o40[, 1:8], col = gmm_d8k3n4000o40$G + 1)
gross_d8k3n4000o40 <- find_gross(
gmm_d8k3n4000o40[, 1:8], 80
)
gross_d8k3n4000o40$plot
ombc_d8k3n4000o40 <- ombc_gmm(
gmm_d8k3n4000o40[, 1:4], 3, 80,
gross_outs = gross_d8k3n4000o40$bool,
print_interval = 10
)
ombc_d8k3n4000o40$plot_curves
plot(gmm_d8k3n4000o40[, 1:8], col = gmm_d8k3n4000o40$G + 1)
ombc_d4k3n4000o40$plot_curves
ombc_d8k3n4000o40$plot_curves
mclust::nMclustParams("VVV", 16, 3)
gmm_d16k3n4000o40 <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(
c(-1, 0, rep(0, 14)),
c(+1, -1, rep(0, 14)),
c(+1, +1, rep(0, 14))),
sigma = list(
diag(c(0.2, 4 * 0.2, rep(0.2, 14))),
diag(c(0.2, 0.2, rep(0.2, 14))),
diag(c(0.2, 0.2, rep(0.2, 14)))
),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
plot(gmm_d16k3n4000o40[, 1:8], col = gmm_d16k3n4000o40$G + 1)
gross_d16k3n4000o40 <- find_gross(
gmm_d16k3n4000o40[, 1:8], 80
)
gross_d16k3n4000o40$plot
ombc_d16k3n4000o40 <- ombc_gmm(
gmm_d16k3n4000o40[, 1:4], 3, 80,
gross_outs = gross_d16k3n4000o40$bool,
print_interval = 10
)
ombc_d16k3n4000o40$plot_curves
rep(1, 0)
c(rep(1, 0), 2)
2^(0:15 * 100)
2^(0:15) * 100
500 * 16
gmm_d16k16n8000o80 <- simulate_gmm(
n = rep(500, 16),
mu = list(
c(rep(+1, 0), -1, rep(0, 15)),
c(rep(+1, 1), -1, rep(0, 14)),
c(rep(+1, 2), -1, rep(0, 13)),
c(rep(+1, 3), -1, rep(0, 12)),
c(rep(+1, 4), -1, rep(0, 11)),
c(rep(+1, 5), -1, rep(0, 10)),
c(rep(+1, 6), -1, rep(0, 9)),
c(rep(+1, 7), -1, rep(0, 8)),
c(rep(+1, 8), -1, rep(0, 7)),
c(rep(+1, 9), -1, rep(0, 6)),
c(rep(+1, 10), -1, rep(0, 5)),
c(rep(+1, 11), -1, rep(0, 4)),
c(rep(+1, 12), -1, rep(0, 3)),
c(rep(+1, 13), -1, rep(0, 2)),
c(rep(+1, 14), -1, rep(0, 1)),
c(rep(+1, 15), -1, rep(0, 0))
),
sigma = list(
diag(c(rep(0.2, 0), 0.2, rep(4 * 0.2, 15))),
diag(c(rep(0.2, 1), 0.2, rep(4 * 0.2, 14))),
diag(c(rep(0.2, 2), 0.2, rep(4 * 0.2, 13))),
diag(c(rep(0.2, 3), 0.2, rep(4 * 0.2, 12))),
diag(c(rep(0.2, 4), 0.2, rep(4 * 0.2, 11))),
diag(c(rep(0.2, 5), 0.2, rep(4 * 0.2, 10))),
diag(c(rep(0.2, 6), 0.2, rep(4 * 0.2, 9))),
diag(c(rep(0.2, 7), 0.2, rep(4 * 0.2, 8))),
diag(c(rep(0.2, 8), 0.2, rep(4 * 0.2, 7))),
diag(c(rep(0.2, 9), 0.2, rep(4 * 0.2, 6))),
diag(c(rep(0.2, 10), 0.2, rep(4 * 0.2, 5))),
diag(c(rep(0.2, 11), 0.2, rep(4 * 0.2, 4))),
diag(c(rep(0.2, 12), 0.2, rep(4 * 0.2, 3))),
diag(c(rep(0.2, 13), 0.2, rep(4 * 0.2, 2))),
diag(c(rep(0.2, 14), 0.2, rep(4 * 0.2, 1))),
diag(c(rep(0.2, 15), 0.2, rep(4 * 0.2, 0)))
),
outlier_num = 80,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
table(gmm_d16k16n8000o80$G)
simulate_big_gmm <- function(d) {
mu_list <- sigma_list <- list()
for (i in 1:d) {
mu_list[[i]] <- c(rep(+1, i - 1), -1, rep(0, d - i))
sigma_list[[i]] <- diag(c(rep(0.2, i - 1), 0.2, rep(4 * 0.2, d - i)))
}
sim_gmm <- simulate_gmm(
n = rep(500, d),
mu = mu_list,
sigma = sigma_list,
outlier_num = 5 * d,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
}
gmm_d4k4n2000o20 <- simulate_big_gmm(4)
table(gmm_d4k4n2000o20)
table(gmm_d4k4n2000o20$G)
gmm_d4k4n2000o20 <- simulate_big_gmm(1)
simulate_big_gmm <- function(d) {
mu_list <- sigma_list <- list()
for (i in 1:d) {
mu_list[[i]] <- c(rep(+1, i - 1), -1, rep(0, d - i))
sigma_list[[i]] <- diag(c(rep(0.2, i - 1), 0.2, rep(4 * 0.2, d - i)))
}
sim_gmm <- simulate_gmm(
n = rep(500, d),
mu = mu_list,
sigma = sigma_list,
outlier_num = 5 * d,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
}
gmm_d4k4n2000o20 <- simulate_big_gmm(2)
table(gmm_d4k4n2000o20$G)
gmm_d4k4n2000o20 <- simulate_big_gmm(1)
dim_seq <- 2^1:10
dim_seq <- 2^(1:10)
dim_seq
dim_seq <- 2^(1:5)
head(gmm_d4k4n2000o20[, -G])
head(gmm_d4k4n2000o20[, -"G"])
head(gmm_d4k4n2000o20[, !"G"])
head(gmm_d4k4n2000o20[, -dim_seq[1]])
dim_seq <- 2^(1:5)
big_sim <- big_gross <- big_ombc <- list()
for (i in seq_along(dim_seq)) {
big_sim[[i]] <- simulate_big_gmm(dim_seq[i])
big_gross[[i]] <- find_gross(
big_sim[[i]][, -(dim_seq[i] + 1)],
max_out = 10 * dim_seq[i]
)
big_ombc[[i]] <- ombc_gmm(
big_sim[[i]][, -(dim_seq[i] + 1)],
comp_num = dim_seq[i],
max_out = 10 * dim_seq[i],
gross_outs = big_gross[[i]]$bool,
print_interval = 10
)
}
lympho_folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos/EMMIX_lympho"
)
lympho1_ombc <- readRDS(paste0(lympho_folder, "/lympho1_ombc.rds"))
lympho1_ombc$plot_curves
lympho1_ombc$plot_curves
lympho1_ombc$plot_curves
plot(lympho1_trim_umap, col = lympho1_ombc$labels[, 1])
lympho1_trim_umap <- read.table(paste0(lympho_folder, "/lympho1_trim_umap.txt"))
plot(lympho1_trim_umap, col = lympho1_ombc$labels[, 1])
plot(lympho1_trim_umap, col = lympho1_ombc$labels[, 1] + 1)
lympho1_trim <- read.table(paste0(lympho_folder, "/lympho1_trim.txt"))
plot(lympho1_trim, col = lympho1_ombc$labels[, 1] + 1)
mclust::nMclustParams("VVV", 32, 1)
1000 * 32
1000 * 32 / 100
library(devtools)
load_all()
mclust::nMclustParams("VVV", 32, 32)
2^(1:5)
simulate_big_gmm <- function(d) {
mu_list <- sigma_list <- list()
for (i in 1:d) {
mu_list[[i]] <- c(rep(+1, i - 1), -1, rep(0, d - i))
sigma_list[[i]] <- diag(c(rep(0.2, i - 1), 0.2, rep(4 * 0.2, d - i)))
}
sim_gmm <- outlierMBC::simulate_gmm(
n = rep(1000, d),
mu = mu_list,
sigma = sigma_list,
outlier_num = 10 * d,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
}
dim_seq <- 2^(1:5)
simulate_big_gmm <- function(d) {
mu_list <- sigma_list <- list()
for (i in 1:d) {
mu_list[[i]] <- c(rep(+1, i - 1), -1, rep(0, d - i))
sigma_list[[i]] <- diag(c(rep(0.2, i - 1), 0.2, rep(4 * 0.2, d - i)))
}
sim_gmm <- outlierMBC::simulate_gmm(
n = rep(1000, d),
mu = mu_list,
sigma = sigma_list,
outlier_num = 10 * d,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
}
dim_seq <- 2^(1:5)
16 * 150
16 * 15
mclust::nMclustParams
mclust::nVarParams
simulate_big_gmm <- function(d) {
mu_list <- sigma_list <- list()
for (i in 1:d) {
mu_list[[i]] <- c(rep(+1, i - 1), -1, rep(0, d - i))
sigma_list[[i]] <- diag(c(rep(0.2, i - 1), 0.2, rep(4 * 0.2, d - i)))
}
sim_gmm <- outlierMBC::simulate_gmm(
n = rep(1000, d),
mu = mu_list,
sigma = sigma_list,
outlier_num = 10 * d,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
}
dim_seq <- 2^(1:5)
big_sim32 <- simulate_big_gmm(32)
big_gross32 <- find_gross(big_sim32[, 1:32], max_out = 15 * 32)
big_gross32$plot
load_all()
big_gross32 <- find_gross(big_sim32[, 1:32], max_out = 15 * 32)
search_centre
search_interval <- elbow$search_interval
cpop_fitted <- cpop::fitted(elbow$cpop_out)
gg <- data.frame(outlier_number, knndist_sort) |>
ggplot2::ggplot(ggplot2::aes(x = outlier_number, y = knndist_sort)) +
ggplot2::geom_line() +
ggplot2::geom_vline(xintercept = search_interval, linetype = "dashed") +
ggplot2::geom_vline(xintercept = elbow_choice) +
ggplot2::geom_vline(xintercept = gross_choice, colour = "red") +
ggplot2::geom_abline(
slope = cpop_fitted$gradient[1], intercept = cpop_fitted$intercept[1],
linetype = "dotted"
) +
ggplot2::geom_abline(
slope = cpop_fitted$gradient[2], intercept = cpop_fitted$intercept[2],
linetype = "dotted"
) +
ggplot2::labs(
title = paste0(
"Chosen number of gross outliers = ", gross_choice
),
subtitle = paste0(
"Elbow choice = ", elbow_choice,
" (search interval = [", search_interval[1],
", ", search_interval[2],
"]), gross proportion = ", round(gross_prop, 2)
),
x = "Outlier Number",
y = paste0("kNN Distance (k = ", k_neighbours, ")")
)
gg + ggplot2::geom_vline(xintercept = 373)
gg + ggplot2::geom_vline(xintercept = 373, colour = "blue")
gg + ggplot2::geom_vline(xintercept = 300, colour = "blue")
gg + ggplot2::geom_vline(xintercept = 320, colour = "blue")
knndist_sort[310:330]
plot(diffs(knndist_sort))
plot(diff(knndist_sort))
plot(diff(knndist_sort), type = "l")
plot(scale(diff(knndist_sort)), type = "l")
cpt::cpt.mean(diff(knndist_sort))
changepoint::cpt.mean(diff(knndist_sort))
changepoint::cpt.mean(knndist_sort)
?cpop::cpop
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD",
"/Programming/outlierMBC_demos/uef_sipu_data/outlier_datasets"
)
noisy_s1 <- read.table(paste0(folder, "/noisy/noisy_s1.txt"))
gross_noisy_s1 <- outlierMBC::find_gross(noisy_s1, 500)
load_all()
gross_noisy_s1 <- outlierMBC::find_gross(noisy_s1, 500)
gg
changepoint::cpt.mean(knndist_sort)
gg + ggplot2::geom_vline(xintercept = 200)
gg + ggplot2::geom_vline(xintercept = 200, colour = "blue")
search_centre
plot(knndist_sort, type = "l")
plot(diff(knndist_sort), type = "l")
plot(scale(diff(knndist_sort)), type = "l")
abline(v = 309)
abline(v = 200)
elbow_choice
abline(v = 294)
big_gross32 <- find_gross(big_sim32[, 1:32], max_out = 15 * 32)
cpop_fitted$RSS
plot(knndist_sort, type = "l")
changepoint::cpt.mean(knndist_sort)
abline(v = 320)
lm1 <- lm(knndist_sort[1:320])
lm1 <- lm(c(1:320) ~ knndist_sort[1:320])
summary(lm1)
lm1 <- lm(c(321:960) ~ knndist_sort[321:960])
lm2 <- lm(c(321:960) ~ knndist_sort[321:960])
lm1 <- lm(c(1:320) ~ knndist_sort[1:320])
sum(lm1$residuals^2)
sum(lm2$residuals^2)
lm1 <- lm(knndist_sort[1:320] ~ c(1:320))
lm2 <- lm(knndist_sort[321:960] ~ c(321:960))
sum(lm1$residuals^2)
sum(lm2$residuals^2)
search_centre
lm1 <- lm(knndist_sort[1:373] ~ c(1:373))
lm2 <- lm(knndist_sort[374:960] ~ c(374:960))
sum(lm1$residuals^2)
sum(lm2$residuals^2)
elbow_choice
lm1 <- lm(knndist_sort[1:444] ~ c(1:444))
lm2 <- lm(knndist_sort[444:960] ~ c(444:960))
sum(lm1$residuals^2)
sum(lm2$residuals^2)
ultan <- c()
length(ultan)
?append
append(ultan, 1)
?lm
?ggplot2::geom_linerange
?ggplot2::geom_segment
?ggplot2::geom_abline
?ggplot2::geom_smooth
load_all()
find_gross2(noisy_s1, 500)
load_all()
find_gross2(noisy_s1, 500)
find_gross2(noisy_s1, 500)
load_all()
find_gross2(noisy_s1, 500)
str(best_test)
tests
load_all()
find_gross2(noisy_s1, 500)
lm1
lm2
load_all()
find_gross2(noisy_s1, 500)
best_test
test_scores
load_all()
find_gross2(noisy_s1, 500)
load_all()
find_gross2(noisy_s1, 500)$plot
234 /0.8
292 * 0.8
find_gross2(big_sim32, 480)$plot
load_all()
find_gross2(noisy_s1, 500)$plot
load_all()
find_gross2(noisy_s1, 500)$plot
load_all()
find_gross2(noisy_s1, 500)$plot
load_all()
find_gross2(noisy_s1, 500)$plot
find_gross2(big_sim32, 480)$plot
load_all()
find_gross2(noisy_s1, 500)$plot
load_all()
find_gross2(noisy_s1, 500)$plot
load_all()
find_gross2(noisy_s1, 500)$plot
find_gross2(big_sim32, 480)$plot
scales::show_col(ggokabeito::palette_okabe_ito())
ggokabeito::palette_okabe_ito()
load_all()
find_gross2(noisy_s1, 500)$plot
load_all()
find_gross2(noisy_s1, 500)$plot
find_gross2(big_sim32, 480)$plot
load_all()
find_gross2(noisy_s1, 500)$plot
