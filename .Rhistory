gross2_noisy_s1$plot
find_gross2(noisy_s2, 500)
find_gross2(noisy_s3, 500)
find_gross2(noisy_s4, 500)
find_gross2(noisy_a1, 300)
find_gross2(noisy_a2, 525)
find_gross2(noisy_a3, 750)
find_gross2(noisy_unbal, 650)
find_gross2(noisy_dim32, 110)
gross2_resim_s1 <- find_gross2(resim_s1, 500)
gross2_resim_s1$plot
gross2_clean_s1 <- find_gross2(clean_s1, 500)
gross2_clean_s1$plot
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
gross2_k3n1000o10$plot
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
gross2_k3n1000o10$plot
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
gross2_k3n1000o10$plot
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
gross2_k3n1000o10$plot
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
gross2_k3n1000o10$plot
load_all()
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
gross2_k3n1000o10$plot
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
gross2_k3n1000o10$plot
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
gross2_k3n1000o10$plot
nnclean_k3n1000o10 <- prabclus::NNclean(
gmm_k3n1000o10[, 1:2], 200
)
table(nnclean_k3n1000o10$z)
nnclean_k3n1000o10 <- prabclus::NNclean(
gmm_k3n1000o10[, 1:2], 10
)
table(nnclean_k3n1000o10$z)
nnve_k3n1000o10 <- covRobust::cov.nnve(
gmm_k3n1000o10[, 1:2], k = 12, devsm = 0.1
)
table(nnve_k3n1000o10$classification)
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
gross2_k3n1000o10$plot
plot(iris[, 2])
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
gross2_k3n1000o10$plot
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
gross2_k3n1000o10$plot
load_all()
gross2_k3n1000o10 <- find_gross2(gmm_k3n1000o10[, -3], 20) # 7
gross2_k3n1000o10$plot
gross2_noisy_s1 <- find_gross2(noisy_s1, 500)
gross2_noisy_s1$plot
gross2_clean_s1 <- find_gross2(clean_s1, 500)
gross2_clean_s1$plot
gross2_clean_s1 <- find_gross2(clean_s1, 100)
gross2_clean_s1$plot
gross2_clean_s1 <- find_gross2(clean_s1, 50)
gross2_clean_s1$plot
?ggplot2::annotate
?ggpubr::annotate_figure
?ggsave
class(gross2_clean_s1$plot)
gross2_clean_s1$plot$layers
folder
ggsave(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/gross2_clean_s1.png",
gross2_clean_s1$plot
)
gross2_clean_s1_plot <- gross2_clean_s1$plot
gross2_clean_s1_plot + theme(theme(panel.background = element_rect(fill='green', colour='red')))
gross2_clean_s1_plot + theme(theme(plot.background = element_rect(fill='green', colour='red')))
ggsave(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/gross2_clean_s1.png",
gross2_clean_s1_plot
)
gross2_clean_s1_plot + ggpubr::bgcolor("white")
ggsave(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/gross2_clean_s1.png",
gross2_clean_s1_plot
)
ggsave(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/gross2_clean_s1.png",
gross2_clean_s1_plot
)
gross2_clean_s1_plot + ggpubr::bgcolor("red")
gross2_clean_s1_plot <- gross2_clean_s1$plot + ggpubr::bgcolor("white")
gross2_clean_s1_plot
ggsave(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/gross2_clean_s1.png",
gross2_clean_s1_plot
)
load_all()
gross2_resim_s1 <- find_gross2(resim_s1, 500)
gross2_resim_s1 <- find_gross(resim_s1, 500)
gross2_resim_s1$plot
gross2_resim_s1 <- find_gross(resim_s1, 500, manual_gross_threshold = 0.5)
gross2_resim_s1$plot
gross_k3n1000o10 <- find_gross(gmm_k3n1000o10[, 1:2], 20)
gross_k3n1000o10$plot
ombc_k3n1000o10 <- ombc_gmm(
gmm_k3n1000o10[, 1:2], 3, 20,
gross_outs = gross_k3n1000o10$gross_bool,
print_interval = 10
)
ombc_k3n1000o10$curve_plot
ombc_k3n1000o10$tail_curve_plot
plot(
gmm_k3n1000o10[, 1:2],
col = ombc_k3n1000o10$labels$full + 1,
pch = gross_k3n1000o10$gross_bool + 1
)
gross_k3n2000o20 <- find_gross(gmm_k3n2000o20[, 1:2], 40)
gross_k3n2000o20$plot
ombc_k3n2000o20 <- ombc_gmm(
gmm_k3n2000o20[, 1:2], 3, 40,
gross_outs = gross_k3n2000o20$gross_bool,
print_interval = 10
)
ombc_k3n2000o20$curve_plot
ombc_k3n2000o20$tail_curve_plot
gross_k3n4000o40 <- find_gross(gmm_k3n4000o40[, 1:2], 80)
gross_k3n4000o40$plot
install()
check()
check()
lintr:::addin_lint_package()
lintr:::addin_lint_package()
lintr:::addin_lint_package()
styler:::style_active_pkg()
?find_gross
document()
?find_gross
document()
?find_gross
document()
?find_gross
document()
?find_gross
document()
?find_gross
#' @param k_neighbours Number of neighbours for dbscan::kNNdist.
#' @param manual_gross_threshold Optional preset number of gross outliers.
#' @param scale Logical
#'
#' @return List:
#' * $choice: a numeric value indicating the elbow's location.
#' * $bool: a logical vector identifying the gross outliers.
#' * $plot
#'
#' @export
find_gross <- function(
x,
max_out,
multiplier = 3,
k_neighbours = floor(nrow(x) / 100),
manual_gross_threshold = NULL,
scale = TRUE) {
outlier_number <- seq_len(2 * max_out)
if (scale) {
x <- scale(x)
}
x_knndist <- dbscan::kNNdist(x, k_neighbours)
knndist_sort <- -sort(-x_knndist)[outlier_number]
knndist_benchmark <- knndist_sort[max_out + 1]
if (is.null(manual_gross_threshold)) {
gross_threshold <- multiplier * knndist_benchmark
} else {
gross_threshold <- manual_gross_threshold
multiplier <- NA
}
gross_bool <- x_knndist > gross_threshold
gross_choice <- sum(gross_bool)
gross <- NULL
curve <- data.frame(
outlier_number, knndist_sort,
gross = outlier_number <= gross_choice
) |>
ggplot2::ggplot(
ggplot2::aes(x = outlier_number, y = knndist_sort, colour = gross)
) +
ggplot2::geom_point(
size = min(1, max(0.1, 100 / max_out)), show.legend = FALSE
) +
ggplot2::geom_hline(yintercept = gross_threshold, colour = "#E69F00") +
ggplot2::labs(
x = "kNN Distance Order",
y = paste0("kNN Distance (k = ", k_neighbours, ")"),
colour = "Outlier Number Choices:"
) +
ggplot2::theme(legend.position = "bottom") +
ggplot2::expand_limits(y = 0) +
ggplot2::scale_colour_manual(values = c("#000000", "#E69F00"))
if (is.null(manual_gross_threshold)) {
curve <- curve +
ggplot2::geom_linerange(
ymax = knndist_benchmark, ymin = 0, x = max_out,
linetype = "dashed", colour = "black", show.legend = FALSE
) +
ggplot2::geom_linerange(
y = knndist_benchmark, xmin = 0, xmax = max_out,
linetype = "dashed", colour = "black", show.legend = FALSE
)
}
x_seq <- NULL
scatter <- data.frame(x_seq = seq_len(nrow(x)), x_knndist, gross_bool) |>
ggplot2::ggplot(ggplot2::aes(
x = x_seq, y = x_knndist, colour = gross_bool
)) +
ggplot2::geom_point(
size = min(1, max(0.1, 100 / max_out)), show.legend = FALSE
) +
ggplot2::geom_hline(yintercept = 3 * knndist_benchmark, colour = "#E69F00") +
ggplot2::labs(
x = "Index",
y = paste0("kNN Distance (k = ", k_neighbours, ")")
) +
ggplot2::expand_limits(y = 0) +
ggplot2::scale_colour_manual(values = c("#000000", "#E69F00"))
if (is.null(manual_gross_threshold)) {
scatter <- scatter +
ggplot2::geom_hline(yintercept = knndist_benchmark, linetype = "dashed")
}
plot <- ggpubr::annotate_figure(
ggpubr::ggarrange(curve, scatter, nrow = 1, ncol = 2),
top = paste0(
"No. of Gross Outliers = ", gross_choice,
" (max_out = ", max_out, ", multiplier = ", multiplier, ")"
)
) + ggpubr::bgcolor("white")
output <- list(
gross_choice = gross_choice,
gross_bool = gross_bool,
plot = plot
)
return(output)
}
document()
document()
load_all()
?find_gross
install()
?mclust::banknote
install()
load_all()
gross_k3n1000o10 <- find_gross(gmm_k3n1000o10[, 1:2], 20)
gross_k3n1000o10$plot
load_all()
gross_k3n1000o10 <- find_gross(gmm_k3n1000o10[, 1:2], 20)
gross_k3n1000o10$plot
ombc_k3n1000o10 <- ombc_gmm(
gmm_k3n1000o10[, 1:2], 3, 20,
gross_outs = gross_k3n1000o10$gross_bool,
print_interval = 10
)
gross_k3n1000o10 <- find_gross(gmm_k3n1000o10[, 1:2], 20)
gross_k3n1000o10$plot
gross_k3n2000o20 <- find_gross(gmm_k3n2000o20[, 1:2], 40)
gross_k3n2000o20$plot
load_all()
gross_k3n1000o10 <- find_gross(gmm_k3n1000o10[, 1:2], 20)
gross_k3n1000o10$plot
gross_k3n2000o20 <- find_gross(gmm_k3n2000o20[, 1:2], 40)
gross_k3n2000o20$plot
gross_k3n4000o40 <- find_gross(gmm_k3n4000o40[, 1:2], 80)
gross_k3n4000o40$plot
gross_p2n1m1s1 <- find_gross(samps_p2n1$m1$s1[, -3], 150) # 87
samps_p2n1 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/tclust_simulation/samps_p2n1.rds")
samps_p2n2 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/tclust_simulation/samps_p2n2.rds")
samps_p6n1 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/tclust_simulation/samps_p6n1.rds")
samps_p6n2 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/tclust_simulation/samps_p6n2.rds")
gross_p2n1m1s1 <- find_gross(samps_p2n1$m1$s1[, -3], 150) # 87
gross_p2n1m1s1$plot
gross_p2n1m2s1 <- find_gross(samps_p2n1$m2$s1[, -3], 150) # 78
gross_p2n1m2s1$plot
gross_p2n1m3s1 <- find_gross(samps_p2n1$m3$s1[, -3], 150) # 85
gross_p2n1m3s1$plot
gross_p2n1m4s1 <- find_gross(samps_p2n1$m4$s1[, -3], 150) # 94
gross_p2n1m4s1$plot
gross_p2n1m5s1 <- find_gross(samps_p2n1$m5$s1[, -3], 150) # 9
gross_p2n1m5s1$plot
gross_noisy_s1 <- find_gross(noisy_s1, 500)
gross_noisy_s1$plot
gross_noisy_s2 <- find_gross(noisy_s2, 500)
gross_noisy_s2$plot
gross_noisy_s3 <- find_gross(noisy_s3, 500)
gross_noisy_s3$plot
gross_noisy_s4 <- find_gross(noisy_s4, 500)
gross_noisy_s4$plot
gross_noisy_a1 <- find_gross(noisy_a1, 300)
gross_noisy_a1$plot
gross_noisy_a2 <- find_gross(noisy_a2, 525)
gross_noisy_a2$plot
gross_noisy_a3 <- find_gross(noisy_a3, 750)
gross_noisy_a3$plot
gross_noisy_unbal <- find_gross(noisy_unbal, 650)
gross_noisy_unbal$plot
gross_noisy_dim32 <- find_gross(noisy_dim32, 110)
gross_noisy_dim32$plot
document()
check()
document()
check()
lintr:::addin_lint_package()
styler:::style_active_pkg()
gross_p6n1m1s1 <- find_gross(samps_p6n1$m1$s1[, -3], 150) # 87
gross_p6n1m1s1$plot
gross_p6n1m5s1 <- find_gross(samps_p6n1$m5$s1[, -3], 150) # 87
gross_p6n1m5s1$plot
load_all()
library(devtools)
load_all()
gross_k3n1000o10 <- find_gross(gmm_k3n1000o10[, 1:2], 20)
gross_k3n1000o10$plot
ombc_k3n1000o10 <- ombc_gmm(
gmm_k3n1000o10[, 1:2], 3, 20,
gross_outs = gross_k3n1000o10$gross_bool,
print_interval = 10
)
load_all()
gross_k3n1000o10 <- find_gross(gmm_k3n1000o10[, 1:2], 20)
gross_k3n1000o10$plot
ombc_k3n1000o10 <- ombc_gmm(
gmm_k3n1000o10[, 1:2], 3, 20,
gross_outs = gross_k3n1000o10$gross_bool,
print_interval = 10
)
ombc_k3n1000o10$outlier_num
plot(ombc_k3n1000o10$distrib_diff_mat[, 3])
load_all()
ombc_k3n1000o10 <- ombc_gmm(
gmm_k3n1000o10[, 1:2], 3, 20,
gross_outs = gross_k3n1000o10$gross_bool,
print_interval = 10
)
ombc_k3n1000o10$outlier_num
plot(ombc_k3n1000o10$distrib_diff_mat[, 3])
gross_k3n2000o20 <- find_gross(gmm_k3n2000o20[, 1:2], 40)
gross_k3n2000o20$plot
ombc_k3n2000o20 <- ombc_gmm(
gmm_k3n2000o20[, 1:2], 3, 40,
gross_outs = gross_k3n2000o20$gross_bool,
print_interval = 10
)
ombc_k3n2000o20$outlier_num
plot(ombc_k3n2000o20$distrib_diff_mat[, 3])
plot(ombc_k3n2000o20$distrib_diff_mat[, 1])
gross_k3n4000o40 <- find_gross(gmm_k3n4000o40[, 1:2], 80)
gross_k3n4000o40$plot
ombc_k3n4000o40 <- ombc_gmm(
gmm_k3n4000o40[, 1:2], 3, 80,
gross_outs = gross_k3n4000o40$gross_bool,
print_interval = 10
)
ombc_k3n4000o40$outlier_num
plot(ombc_k3n4000o40$distrib_diff_mat[, 3])
plot(ombc_k3n4000o40$distrib_diff_mat[, 1])
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD",
"/Programming/outlierMBC_demos/uef_sipu_data/outlier_datasets"
)
library(tidyverse)
noisy_s1 <- read.table(paste0(folder, "/noisy/noisy_s1.txt"))
gross_noisy_s1 <- find_gross(
noisy_s1, 500
)
gross_noisy_s1$plot
ombc_noisy_s1 <- ombc_gmm(
noisy_s1, 15, 500,
gross_outs = gross_noisy_s1$bool,
print_interval = 10
)
ombc_noisy_s1 <- ombc_gmm(
noisy_s1, 15, 500,
gross_outs = gross_noisy_s1$gross_bool,
print_interval = 10
)
ombc_noisy_s1$outlier_num
plot(ombc_noisy_s1$distrib_diff_mat[, 3])
plot(ombc_noisy_s1$distrib_diff_mat[, 1])
max(ombc_noisy_s1$distrib_diff_mat[, 1] - ombc_noisy_s1$distrib_diff_mat[, 3])
load_all()
gross_k3n1000o10 <- find_gross(gmm_k3n1000o10[, 1:2], 20)
gross_k3n1000o10$plot
ombc_k3n1000o10 <- ombc_gmm(
gmm_k3n1000o10[, 1:2], 3, 20,
gross_outs = gross_k3n1000o10$gross_bool,
print_interval = 10
)
ombc_k3n1000o10$outlier_num
plot(ombc_k3n1000o10$distrib_diff_mat[, 1])
plot(ombc_k3n1000o10$distrib_diff_mat[, 3])
ombc_k3n2000o20 <- ombc_gmm(
gmm_k3n2000o20[, 1:2], 3, 40,
gross_outs = gross_k3n2000o20$gross_bool,
print_interval = 10
)
ombc_k3n2000o20$outlier_num
plot(ombc_k3n2000o20$distrib_diff_mat[, 3])
plot(ombc_k3n2000o20$distrib_diff_mat[, 1])
ombc_k3n4000o40 <- ombc_gmm(
gmm_k3n4000o40[, 1:2], 3, 80,
gross_outs = gross_k3n4000o40$gross_bool,
print_interval = 10
)
ombc_k3n4000o40$outlier_num
plot(ombc_k3n4000o40$distrib_diff_mat[, 1])
plot(ombc_k3n4000o40$distrib_diff_mat[, 3])
load_all()
ombc_noisy_s1 <- ombc_gmm(
noisy_s1, 15, 500,
gross_outs = gross_noisy_s1$gross_bool,
print_interval = 10
)
ombc_noisy_s1$outlier_num
matplot(ombc_noisy_s1$distrib_diff_mat)
matplot(ombc_noisy_s1$distrib_diff_mat[, -2])
load_all()
ombc_k3n1000o10 <- ombc_gmm(
gmm_k3n1000o10[, 1:2], 3, 20,
gross_outs = gross_k3n1000o10$gross_bool,
print_interval = 10
)
ombc_k3n1000o10$outlier_num
load_all()
ombc_k3n1000o10 <- ombc_gmm(
gmm_k3n1000o10[, 1:2], 3, 20,
gross_outs = gross_k3n1000o10$gross_bool,
print_interval = 10
)
ombc_k3n1000o10$outlier_num
ombc_k3n2000o20 <- ombc_gmm(
gmm_k3n2000o20[, 1:2], 3, 40,
gross_outs = gross_k3n2000o20$gross_bool,
print_interval = 10
)
ombc_k3n2000o20$outlier_num
ombc_k3n4000o40 <- ombc_gmm(
gmm_k3n4000o40[, 1:2], 3, 80,
gross_outs = gross_k3n4000o40$gross_bool,
print_interval = 10
)
ombc_k3n4000o40$outlier_num
ombc_noisy_s1 <- ombc_gmm(
noisy_s1, 15, 500,
gross_outs = gross_noisy_s1$gross_bool,
print_interval = 10
)
ombc_noisy_s1$outlier_num
load_all()
load_all()
ombc_k3n1000o10 <- ombc_gmm(
gmm_k3n1000o10[, 1:2], 3, 20,
gross_outs = gross_k3n1000o10$gross_bool,
print_interval = 10
)
ombc_k3n1000o10$outlier_num
matplot(ombc_k3n1000o10$distrib_diff_mat)
matplot(ombc_k3n1000o10$distrib_diff_mat[, -2])
which.min(ombc_k3n1000o10$distrib_diff_mat[, 3])
load_all()
ombc_k3n1000o10 <- ombc_gmm(
gmm_k3n1000o10[, 1:2], 3, 20,
gross_outs = gross_k3n1000o10$gross_bool,
print_interval = 10
)
ombc_k3n1000o10$outlier_num
ombc_k3n2000o20 <- ombc_gmm(
gmm_k3n2000o20[, 1:2], 3, 40,
gross_outs = gross_k3n2000o20$gross_bool,
print_interval = 10
)
ombc_k3n2000o20$outlier_num
ombc_k3n4000o40 <- ombc_gmm(
gmm_k3n4000o40[, 1:2], 3, 80,
gross_outs = gross_k3n4000o40$gross_bool,
print_interval = 10
)
ombc_k3n4000o40$outlier_num
ombc_noisy_s1 <- ombc_gmm(
noisy_s1, 15, 500,
gross_outs = gross_noisy_s1$gross_bool,
print_interval = 10
)
ombc_noisy_s1$outlier_num
matplot(ombc_noisy_s1$distrib_diff_mat)
matplot(ombc_noisy_s1$distrib_diff_mat[, -2])
matplot(ombc_noisy_s1$distrib_diff_mat[, -2], type = "l")
