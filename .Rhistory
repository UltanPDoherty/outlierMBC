identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 34)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 33)$choice, 1)$outlier_num
changepoints <- 31:45
sd_factors <- seq(0.1, 2, 0.1)
outnums <- matrix(nrow = length(changepoints), ncol = length(sd_factors))
changepoints <- 31:45
sd_factors <- seq(0.1, 2, 0.1)
outnums <- matrix(nrow = length(changepoints), ncol = length(sd_factors))
for (i in seq_along(changepoints)) {
for (j in seq_along(sd_factors)) {
outnums[i, j] <- identify_outliers(
outback_k3gmm$densities,
changepoints[i],
sd_factors[j])$outlier_num
}
}
outnums
table(outnums)
sd_factors <- seq(0.5, 2, 0.5)
outnums <- matrix(nrow = length(changepoints), ncol = length(sd_factors))
for (i in seq_along(changepoints)) {
for (j in seq_along(sd_factors)) {
outnums[i, j] <- identify_outliers(
outback_k3gmm$densities,
changepoints[i],
sd_factors[j])$outlier_num
}
}
outnums
outnums <- matrix(nrow = length(changepoints), ncol = length(sd_factors),
dimnames = list(changepoints, sd_factors))
for (i in seq_along(changepoints)) {
for (j in seq_along(sd_factors)) {
outnums[i, j] <- identify_outliers(
outback_k3gmm$densities,
changepoints[i],
sd_factors[j])$outlier_num
}
}
outnums
use_cpop(outback_k3gmm$densities, 40)$choice
mod1 <- lm(outback_k3gmm$densities[1:42] ~ c(1:42))
mod2 <- lm(outback_k3gmm$densities[43:80] ~ c(43:80))
fit1 <- mod1$coefficients[1] + outback_k3gmm$densities[1:42] * mod1$coefficients[1]
fit2 <- mod2$coefficients[1] + outback_k3gmm$densities[1:42] * mod2$coefficients[1]
outback_k3gmm$densities - fit1
fit1 <- mod1$coefficients[1] + outback_k3gmm$densities * mod1$coefficients[1]
fit2 <- mod2$coefficients[1] + outback_k3gmm$densities * mod2$coefficients[1]
outback_k3gmm$densities - fit1
plot(outback_k3gmm$densities - fit1, type = "l"
plot(outback_k3gmm$densities - fit1, type = "l")
lines(outback_k3gmm$densities - fit2, type = "l")
outback_k3gmm$densities - fit2
fit1 <- mod1$coefficients[1] + outback_k3gmm$densities * mod1$coefficients[2]
fit2 <- mod2$coefficients[1] + outback_k3gmm$densities * mod2$coefficients[2]
plot(outback_k3gmm$densities - fit1, type = "l")
lines(outback_k3gmm$densities - fit2)
fit1 <- mod1$coefficients[1] + c(1:80) * mod1$coefficients[2]
fit2 <- mod2$coefficients[1] + c(1:80) * mod2$coefficients[2]
plot(outback_k3gmm$densities - fit1, type = "l")
lines(outback_k3gmm$densities - fit2)
par(mfrow = c(1, 2))
plot(outback_k3gmm$densities - fit1, type = "l")
plot(outback_k3gmm$densities - fit2, type = "l")
par(mfrow = c(1, 1))
mod1 <- lm(outback_k3gmm$densities[1:42] ~ c(1:42))
mod2 <- lm(outback_k3gmm$densities[43:80] ~ c(43:80))
fit1 <- mod1$coefficients[1] + c(1:80) * mod1$coefficients[2]
fit2 <- mod2$coefficients[1] + c(1:80) * mod2$coefficients[2]
par(mfrow = c(1, 2))
plot(outback_k3gmm$densities - fit1, type = "l")
length(fit1)
length(outback_k3gmm$densities)
mod1 <- lm(outcast_k3gmm$densities[1:42] ~ c(1:42))
mod2 <- lm(outcast_k3gmm$densities[43:80] ~ c(43:80))
fit1 <- mod1$coefficients[1] + c(1:80) * mod1$coefficients[2]
fit2 <- mod2$coefficients[1] + c(1:80) * mod2$coefficients[2]
par(mfrow = c(1, 2))
plot(outcast_k3gmm$densities - fit1, type = "l")
plot(outcast_k3gmm$densities - fit2, type = "l")
plot(outcast_k3gmm$densities, type = "l")
abline(mod1)
par(mfrow = c(1, 3))
plot(outcast_k3gmm$densities, type = "l")
abline(mod1)
abline(mod2)
plot(outcast_k3gmm$densities - fit1, type = "l")
plot(outcast_k3gmm$densities - fit2, type = "l")
length(outcast_k3gmm$densities)
outcast_k3gmm <- outcast_gmm(k3gmm[, -3], 3, 80)
mod1 <- lm(outcast_k3gmm$densities[1:42] ~ c(1:42))
mod2 <- lm(outcast_k3gmm$densities[43:80] ~ c(43:80))
fit1 <- mod1$coefficients[1] + c(1:80) * mod1$coefficients[2]
fit2 <- mod2$coefficients[1] + c(1:80) * mod2$coefficients[2]
par(mfrow = c(1, 3))
plot(outcast_k3gmm$densities, type = "l")
abline(mod1)
abline(mod2)
plot(outcast_k3gmm$densities - fit1, type = "l")
plot(outcast_k3gmm$densities - fit2, type = "l")
abs(outcast_k3gmm$densities - fit1) < abs(outcast_k3gmm$densities - fit2)
which(abs(outcast_k3gmm$densities - fit1) < abs(outcast_k3gmm$densities - fit2))
which(abs(outcast_k3gmm$densities - fit1) <= abs(outcast_k3gmm$densities - fit2))
changepoints <- 31:45
sd_factors <- seq(0.5, 5, 0.5)
outnums <- matrix(nrow = length(changepoints), ncol = length(sd_factors),
dimnames = list(changepoints, sd_factors))
for (i in seq_along(changepoints)) {
for (j in seq_along(sd_factors)) {
outnums[i, j] <- identify_outliers(
outback_k3gmm$densities,
changepoints[i],
sd_factors[j])$outlier_num
}
}
outnums
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 40)$choice, 1)$outlier_num
plot(outback_k3gmm$densities, type = "l")
par(mfrow = c(1, 1))
plot(outback_k3gmm$densities, type = "l")
abline(v = 40)
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 41)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 40)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 41)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 36)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 42)$choice, 1)$outlier_num
document()
check()
use_import_from("stats", "lm")
use_import_from("stats", "sd")
use_import_from("cpop", "cpop")
check()
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 36)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 35)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 34)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 33)$choice, 1)$outlier_num
?cpop
cpop1 <- use_cpop(outback_k3gmm$densities, 40)
cpop::residuals(cpop1)
cpop::residuals(cpop1$cpop_out)
load_all()
load_all()
cpop1 <- use_cpop(outback_k3gmm$densities, 40)
load_all()
cpop1 <- use_cpop(outback_k3gmm$densities, 40)
load_all()
cpop1 <- use_cpop(outback_k3gmm$densities, 40)
warnings()
left
y_len
length(left)
width
load_all()
cpop1 <- use_cpop(outback_k3gmm$densities, 40)
load_all()
cpop1 <- use_cpop(outback_k3gmm$densities, 40)
left
right
right - left
sd_vec
plot(sd_vec, type = "l")
lines(1:40, sd1)
length(sd1)
lines(1:40, rep(sd1, 40))
lines(41:80, rep(sd2, 40))
load_all()
use_cpop(outback_k3gmm$densities, 40)$choice
use_cpop(outback_k3gmm$densities, 39)$choice
use_cpop(outback_k3gmm$densities, 38)$choice
use_cpop(outback_k3gmm$densities, 35)$choice
use_cpop(outback_k3gmm$densities, 45)$choice
plot(outback_k3gmm$densities, type = "l")
abline(v = 41)
use_cpop(outcast_k3gmm$densities, 45)$choice
use_cpop(outcast_k3gmm$densities, 40)$choice
use_cpop(outcast_k3gmm$densities, 39)$choice
document()
abline(sd(cpop::residuals(outback_cpop$cpop_out)[1:40]))
abline(h = sd(cpop::residuals(outback_cpop$cpop_out)[1:40]))
abline(h = sd(cpop::residuals(outback_cpop$cpop_out)[41:80]))
sd(cpop::residuals(outback_cpop$cpop_out)[41:80])
sd(cpop::residuals(outback_cpop$cpop_out)[41:60])
abline(h = sd(cpop::residuals(outback_cpop$cpop_out)[41:60]))
load_all()
use_cpop(outcast_k3gmm$densities, 39)$choice
?outback_gmm
outcast_k3gmm <- outcast_gmm(k3gmm[, -3], 3, 80)
plot(outcast_k3gmm$densities, type = "l")
use_cpop(outcast_k3gmm$densities, 2)
use_cpop(outcast_k3gmm$densities, 3)
use_cpop(outcast_k3gmm$densities, 4)
use_cpop(outcast_k3gmm$densities, 5)
use_cpop(outcast_k3gmm$densities, 6)
use_cpop(outcast_k3gmm$densities, 7)
use_cpop(outcast_k3gmm$densities, 8)
use_cpop(outcast_k3gmm$densities, 9)
use_cpop(outcast_k3gmm$densities, 10)
use_cpop(outcast_k3gmm$densities, 11)
use_cpop(outcast_k3gmm$densities, 12)
use_cpop(outcast_k3gmm$densities, 13)
use_cpop(outcast_k3gmm$densities, 20)
use_cpop(outcast_k3gmm$densities, 15)
use_cpop(outcast_k3gmm$densities, 17)
use_cpop(outcast_k3gmm$densities, 16)
use_cpop(outcast_k3gmm$densities, 18)
use_cpop(outcast_k3gmm$densities, 19)
use_cpop(outcast_k3gmm$densities, 20)
load_all()
use_cpop(outcast_k3gmm$densities, 19)
use_cpop(outcast_k3gmm$densities, 15)
use_cpop(outcast_k3gmm$densities, 3)
use_cpop(outcast_k3gmm$densities, 2)
use_cpop(outcast_k3gmm$densities, 1)
use_cpop(outcast_k3gmm$densities, 3)
use_cpop(outcast_k3gmm$densities, 4)
use_cpop(outcast_k3gmm$densities, 5)
y <- outcast_k3gmm$densities
cpop::cpop(
outcast_k3gmm$densities, seq_len(80),
grid = 1:22, minseglen = 22
)
cpop::cpop(
outcast_k3gmm$densities, seq_len(80),
grid = 1:22, minseglen = 23
)
cpop::cpop(
outcast_k3gmm$densities, seq_len(80),
grid = 1:22, minseglen = 10
)
load_all()
use_cpop(outcast_k3gmm$densities, 5)
search_radius
use_cpop(outcast_k3gmm$densities, 4)
search_radius
load_all()
use_cpop(outcast_k3gmm$densities, 4)
load_all()
use_cpop(outcast_k3gmm$densities, 4)
use_cpop(outcast_k3gmm$densities, 76)
use_cpop(outcast_k3gmm$densities, 77)
load_all()
use_cpop(outcast_k3gmm$densities, 77)
use_cpop(outcast_k3gmm$densities, 77)$choice
use_cpop(outcast_k3gmm$densities, 6)$choice
use_cpop(outcast_k3gmm$densities, 7)$choice
load_all()
use_cpop(outcast_k3gmm$densities, 40)
load_all()
use_cpop(outcast_k3gmm$densities, 40)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), aes(x = x, y = y)) +
geom_line()
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot::aes(x = x, y = y)) +
geom_line()
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line()
gg <- ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::annotate("vline", xintercept = choice)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::annotate("vline", xintercept = choice)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::geom_vline(xintercept = choice)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::geom_vline(xintercept = search_interval)
ggplot2::geom_vline(xintercept = choice)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::geom_vline(xintercept = search_interval, linetype = "dashed") +
ggplot2::geom_vline(xintercept = choice)
load_all()
use_cpop(outcast_k3gmm$densities, 40)
use_cpop(outcast_k3gmm$densities, 40)
ultan <- use_cpop(outcast_k3gmm$densities, 40)
ultan$plot
load_all()
use_cpop(outcast_k3gmm$densities, 40)
load_all()
use_cpop(outcast_k3gmm$densities, 40)
load_all()
use_cpop(outcast_k3gmm$densities, 40)
library(devtools)
load_all()
gmm <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(c(-1, 0), c(+1, -1), c(+1, +1)),
sigma = list(diag(c(0.2, 4 * 0.2)), diag(c(0.2, 0.2)), diag(c(0.2, 0.2))),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
k3gmm <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(c(-1, 0), c(+1, -1), c(+1, +1)),
sigma = list(diag(c(0.2, 4 * 0.2)), diag(c(0.2, 0.2)), diag(c(0.2, 0.2))),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
outcast_k3gmm <- outcast_gmm(k3gmm[, -3], 3, 80)
ultan <- use_cpop(outcast_k3gmm$densities, 40)
attr(ultan)
attributes(ultan)
attributes(ultan$cpop_out)
str(ultan$cpop_out)
ultan$cpop_out
unclass(ultan$cpop_out)
?print
class(ultan$cpop_out)
cpop::`.__T__summary:base`
?cpop::`.__T__summary:base`
cpop::summary()
cpop::summary(ultan$cpop_out)
ultan2 <- cpop::summary(ultan$cpop_out)
str(ultan2)
unclass(ultan2)
cpop::summary
broom::tidy(ultan2)
broom::tidy(ultan)
names(summary(ultan))
summary(ultan)
ultan <- use_cpop(outcast_k3gmm$densities, 40)
summary(ultan)
ultan
cpop::fitted(ultan)
cpop::fitted(ultan$cpop_out)
ultan2 <- cpop::fitted(ultan$cpop_out)
str(ultan2)
ultan2$gradient
load_all()
use_cpop(outcast_k3gmm$densities, 40)
check()
load_all()
use_cpop(outcast_k3gmm$densities, 40)
use_package("ggplot2")
document()
check()
devtools::create("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outcast")
document()
check()
document()
library(devtools)
load_all()
document()
document()
check()
document()
check()
?stats::mahalanobis
matrix(c(1, 2, 3, 4))
matrix(c(1, 2, 3, 4), 2, 2)
c(matrix(c(1, 2, 3, 4), 2, 2))
?sweep
?c
?as.vector
?qbeta
?quantile
load_all()
library(devtools)
load_all()
gmm <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(c(-1, 0), c(+1, -1), c(+1, +1)),
sigma = list(diag(c(0.2, 4 * 0.2)), diag(c(0.2, 0.2)), diag(c(0.2, 0.2))),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
betamix_diff
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
matplot(ombc_gmm$distrib_diff_mat, type = "l")
plot(ombc_gmm$betamix_diff)
plot(ombc_gmm$betamix_diff, type = "l")
ombc_gmm$betamix_diff
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
matplot(ombc_gmm$distrib_diff_mat, type = "l")
plot(ombc_gmm$betamix_diff, type = "l")
matplot(ombc_gmm$distrib_diff_mat, type = "l")
lines(ombc_gmm$betamix_diff)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
plot(density(betamix_cdf_vals))
plot(density(mahala_ewcdf_vals))
?quantile
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
plot(density(betamix_cdf_vals))
plot(betamix_cdf_vals)
plot(betamix_cdf_vals, type = "l")
plot(checkpoints, betamix_cdf_vals, type = "l")
plot(checkpoints, mahala_ewcdf_vals, type = "l")
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
checkpoints
plot(checkpoints)
hist(checkpoints)
hist(checkpoints, breaks = 100)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
plot(checkpoints, betamix_cdf_vals, type = "l")
plot(checkpoints, mahala_ewcdf_vals, type = "l")
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
matplot(ombc_gmm$distrib_diff_mat, type = "l")
lines(ombc_gmm$betamix_diff)
min(ombc_gmm$betamix_diff)
which.min(ombc_gmm$betamix_diff)
plot(gmm[, 1:2], col = gmm$G)
plot(gmm[, 1:2], col = gmm$G + 1)
plot(ombc_gmm$distrib_diff_mat[, 1] + ombc_gmm$betamix_diff)
plot(ombc_gmm$distrib_diff_mat[, 1] + ombc_gmm$betamix_diff, type = "l")
plot(scale(ombc_gmm$distrib_diff_mat[, 1]) + scale(ombc_gmm$betamix_diff), type = "l")
?scale
plot(ombc_gmm$distrib_diff_mat[, 1], type = "l"
)
plot(scale(ombc_gmm$distrib_diff_mat[, 3]) + scale(ombc_gmm$betamix_diff), type = "l")
plot(scale(ombc_gmm$distrib_diff_mat[, 2]) + scale(ombc_gmm$betamix_diff), type = "l")
plot(scale(ombc_gmm$distrib_diff_mat[, 1]) + scale(ombc_gmm$betamix_diff), type = "l")
plot(scale(ombc_gmm$distrib_diff_mat[, 4]) + scale(ombc_gmm$betamix_diff), type = "l")
ombc_gmm$outlier_num
which.min(scale(ombc_gmm$distrib_diff_mat[, 3]) + scale(ombc_gmm$betamix_diff))
plot(scale(ombc_gmm$distrib_diff_mat[, 3]) + scale(ombc_gmm$betamix_diff), type = "l")
plot(ombc_gmm$betamix_diff)
plot(ombc_gmm$betamix_diff, type = "l")
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos/s1"
)
s1 <- read.table(paste0(folder, "/s1.txt"))
ombc_s1_123m1000_time <- system.time({
ombc_s1_123m1000 <- ombc_gmm(
x = s1,
comp_num = 15,
max_out = 1000,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
})
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos/s1"
)
s1n <- read.table(paste0(folder, "/s1n.txt"))
ombc_s1n_123m500_time <- system.time({
ombc_s1n_123m500 <- ombc_gmm(
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
})
matplot(ombc_s1n_123m500$distrib_diff_mat, type = "l")
lines(ombc_s1n_123m500$betamix_diff)
?stats::cutree
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
?dist
dist(iris[, -5])
ultan <- dist(iris[, -5])
str(ultan)
str(ultan[1])
str(ultan[[1]])
attr(ultan, "Size")
ultan <- as.matrix(ultan)
hclust(ultan)
hclust(as.dist(ultan))
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
matplot(ombc_gmm$distrib_diff_mat, type = "l")
lines(ombc_gmm$betamix_diff)
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80, reinit_freq = 10)
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80, reinit_interval = 10)
matplot(ombc_gmm$distrib_diff_mat, type = "l")
lines(ombc_gmm$betamix_diff)
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos/s1"
)
s1n <- read.table(paste0(folder, "/s1n.txt"))
ombc_s1n_123m500_time <- system.time({
ombc_s1n_123m500 <- ombc_gmm(
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
})
matplot(ombc_s1n_123m500$distrib_diff_mat)
matplot(ombc_s1n_123m500$distrib_diff_mat, type = "l")
plot(ombc_s1n_123m500$betamix_diff)
plot(ombc_s1n_123m500$betamix_diff, type = "l")
