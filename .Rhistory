identify_outliers <- function(densities, changepoint, sd_factor = 2) {
mod <- lm(densities[1:changepoint] ~ seq_len(changepoint))
fitted <- mod$coefficients[1] + seq_along(densities) * mod$coefficients[2]
res_sd <- sd(mod$residual)
upper_bound <- fitted + sd_factor * res_sd
outlier_num <- max(which(densities < upper_bound))
return(list(
outlier_num = outlier_num,
upper_bound = upper_bound,
fitted = fitted
))
}
id_outback_k3gmm <- identify_outliers(outback_k3gmm$densities, 2)
id_outback_k3gmm <- identify_outliers(outback_k3gmm$densities, 2)
identify_outliers <- function(densities, changepoint, sd_factor = 2) {
mod <- lm(densities[1:changepoint] ~ seq_len(changepoint))
fitted <- mod$coefficients[1] + seq_along(densities) * mod$coefficients[2]
res_sd <- sd(mod$residual)
upper_bound <- fitted + sd_factor * res_sd
browser()
outlier_num <- max(which(densities < upper_bound))
return(list(
outlier_num = outlier_num,
upper_bound = upper_bound,
fitted = fitted
))
}
id_outback_k3gmm <- identify_outliers(outback_k3gmm$densities, 2)
densities < upper_bound
identify_outliers <- function(densities, changepoint, sd_factor = 2) {
mod <- lm(densities[1:changepoint] ~ seq_len(changepoint))
fitted <- mod$coefficients[1] + seq_along(densities) * mod$coefficients[2]
res_sd <- sd(mod$residual)
upper_bound <- fitted + sd_factor * res_sd
outlier_num <- max(which(densities < upper_bound))
return(list(
outlier_num = outlier_num,
upper_bound = upper_bound,
fitted = fitted
))
}
id_outback_k3gmm <- identify_outliers(outback_k3gmm$densities, 1)
id_outback_k3gmm <- identify_outliers(outback_k3gmm$densities, 0.5)
id_outback_k3gmm <- identify_outliers(outback_k3gmm$densities, 40, 2)
plot(outback_k3gmm$densities, type = "l")
lines(id_outback_k3gmm$upper_bound, lty = 2, col = 2)
lines(id_outback_k3gmm$fitted, lty = 2, col = 1)
id_outback_k3gmm
id_outback_k3gmm$outlier_num
id_outback_k3gmm <- identify_outliers(outback_k3gmm$densities, 40, 1)
plot(outback_k3gmm$densities, type = "l")
lines(id_outback_k3gmm$upper_bound, lty = 2, col = 2)
lines(id_outback_k3gmm$fitted, lty = 2, col = 1)
id_outback_k3gmm$outlier_num
lapply(seq(0.1, 2, 0.1), function(x) identify_outliers(outback_k3gmm$densities, 40, x)$outlier_num)
id_outcast_k3gmm <- identify_outliers(outcast_k3gmm$densities, 40, 1)
plot(outcast_k3gmm$densities, type = "l")
lines(id_outcast_k3gmm$upper_bound, lty = 2, col = 2)
lines(id_outcast_k3gmm$fitted, lty = 2, col = 1)
id_outcast_k3gmm$outlier_num
vapply(seq(0.1, 2, 0.1), function(x) identify_outliers(outback_k3gmm$densities, 40, x)$outlier_num, double(1L))
vapply(seq(0.1, 2, 0.1), function(x) identify_outliers(outback_k3gmm$densities, 39, x)$outlier_num, double(1L))
vapply(seq(0.1, 2, 0.1), function(x) identify_outliers(outback_k3gmm$densities, 38, x)$outlier_num, double(1L))
vapply(seq(0.1, 2, 0.1), function(x) identify_outliers(outback_k3gmm$densities, 37, x)$outlier_num, double(1L))
vapply(seq(0.1, 2, 0.1), function(x) identify_outliers(outback_k3gmm$densities, 36, x)$outlier_num, double(1L))
vapply(seq(0.1, 2, 0.1), function(x) identify_outliers(outback_k3gmm$densities, 35, x)$outlier_num, double(1L))
use_cpop(outback_k3gmm$densities, 40)
vapply(seq(0.1, 2, 0.1), function(x) identify_outliers(outback_k3gmm$densities, 42, x)$outlier_num, double(1L))
use_cpop(outback_k3gmm$densities, 41)
use_cpop(outback_k3gmm$densities, 40)
plot(outback_k3gmm$densities, type = "l")
use_cpop <- function(y, search_centre) {
y_len <- length(y)
search_radius <- min(c(
floor((y_len - search_centre - 1) / 3),
floor((y_len - 1) / 3)
))
upper <- search_centre + search_radius
lower <- search_centre - search_radius
search_interval <- c(lower, upper)
sd1 <- sqrt(mean(diff(diff(y[1:search_centre]))^2)/6)
sd2 <- sqrt(mean(diff(diff(y[(search_centre + 1):y_len]))^2)/6)
browser()
cpop_out <- suppressMessages(cpop::cpop(
y, seq_len(y_len),
grid = lower:upper, minseglen = 2 * search_radius + 1,
sd = c(rep(sd1, search_centre), rep(sd2, y_len - search_centre))
))
stopifnot(length(cpop_out@changepoints) == 3)
cat("search centre = ", search_centre)
cat(", search radius = ", search_radius)
cat(", search interval = ", search_interval)
cat(", search choice = ", cpop_out@changepoints[2], "\n")
return(list(
choice = cpop_out@changepoints[2],
search_interval = search_interval,
cpop_out = cpop_out
))
}
use_cpop(outback_k3gmm$densities, 40)
sd1
sd2
use_cpop(outback_k3gmm$densities, 41)
sd1
sd2
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 40), 1)$outlier_num
use_cpop <- function(y, search_centre) {
y_len <- length(y)
search_radius <- min(c(
floor((y_len - search_centre - 1) / 3),
floor((y_len - 1) / 3)
))
upper <- search_centre + search_radius
lower <- search_centre - search_radius
search_interval <- c(lower, upper)
sd1 <- sqrt(mean(diff(diff(y[1:search_centre]))^2)/6)
sd2 <- sqrt(mean(diff(diff(y[(search_centre + 1):y_len]))^2)/6)
cpop_out <- suppressMessages(cpop::cpop(
y, seq_len(y_len),
grid = lower:upper, minseglen = 2 * search_radius + 1,
sd = c(rep(sd1, search_centre), rep(sd2, y_len - search_centre))
))
stopifnot(length(cpop_out@changepoints) == 3)
cat("search centre = ", search_centre)
cat(", search radius = ", search_radius)
cat(", search interval = ", search_interval)
cat(", search choice = ", cpop_out@changepoints[2], "\n")
return(list(
choice = cpop_out@changepoints[2],
search_interval = search_interval,
cpop_out = cpop_out
))
}
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 40), 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 40)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 39)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 40)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 41)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, 30, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, 31, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, 32, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, 33, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, 34, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, 35, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, 36, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, 37, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, 38, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, 39, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, 40, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, 41, 1)$outlier_num
plot(outback_k3gmm$densities[1:41], type = "l")
plot(outback_k3gmm$densities[1:40], type = "l")
plot(outback_k3gmm$densities[1:39], type = "l")
plot(outback_k3gmm$densities[1:38], type = "l")
plot(outback_k3gmm$densities[1:35], type = "l")
plot(outback_k3gmm$densities[1:30], type = "l")
plot(outback_k3gmm$densities, type = "l")
plot(outcast_k3gmm$densities, type = "l")
plot(outcast_k3gmm$densities[1:20], type = "l")
outcast_k3gmm <- outcast_gmm(k3gmm[, -3], 3, 160)
plot(outcast_k3gmm$densities, type = "l")
use_cpop(outback_k3gmm$densities, 40)
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 39)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 38)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 37)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 36)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 35)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 34)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 33)$choice, 1)$outlier_num
changepoints <- 31:45
sd_factors <- seq(0.1, 2, 0.1)
outnums <- matrix(nrow = length(changepoints), ncol = length(sd_factors))
changepoints <- 31:45
sd_factors <- seq(0.1, 2, 0.1)
outnums <- matrix(nrow = length(changepoints), ncol = length(sd_factors))
for (i in seq_along(changepoints)) {
for (j in seq_along(sd_factors)) {
outnums[i, j] <- identify_outliers(
outback_k3gmm$densities,
changepoints[i],
sd_factors[j])$outlier_num
}
}
outnums
table(outnums)
sd_factors <- seq(0.5, 2, 0.5)
outnums <- matrix(nrow = length(changepoints), ncol = length(sd_factors))
for (i in seq_along(changepoints)) {
for (j in seq_along(sd_factors)) {
outnums[i, j] <- identify_outliers(
outback_k3gmm$densities,
changepoints[i],
sd_factors[j])$outlier_num
}
}
outnums
outnums <- matrix(nrow = length(changepoints), ncol = length(sd_factors),
dimnames = list(changepoints, sd_factors))
for (i in seq_along(changepoints)) {
for (j in seq_along(sd_factors)) {
outnums[i, j] <- identify_outliers(
outback_k3gmm$densities,
changepoints[i],
sd_factors[j])$outlier_num
}
}
outnums
use_cpop(outback_k3gmm$densities, 40)$choice
mod1 <- lm(outback_k3gmm$densities[1:42] ~ c(1:42))
mod2 <- lm(outback_k3gmm$densities[43:80] ~ c(43:80))
fit1 <- mod1$coefficients[1] + outback_k3gmm$densities[1:42] * mod1$coefficients[1]
fit2 <- mod2$coefficients[1] + outback_k3gmm$densities[1:42] * mod2$coefficients[1]
outback_k3gmm$densities - fit1
fit1 <- mod1$coefficients[1] + outback_k3gmm$densities * mod1$coefficients[1]
fit2 <- mod2$coefficients[1] + outback_k3gmm$densities * mod2$coefficients[1]
outback_k3gmm$densities - fit1
plot(outback_k3gmm$densities - fit1, type = "l"
plot(outback_k3gmm$densities - fit1, type = "l")
lines(outback_k3gmm$densities - fit2, type = "l")
outback_k3gmm$densities - fit2
fit1 <- mod1$coefficients[1] + outback_k3gmm$densities * mod1$coefficients[2]
fit2 <- mod2$coefficients[1] + outback_k3gmm$densities * mod2$coefficients[2]
plot(outback_k3gmm$densities - fit1, type = "l")
lines(outback_k3gmm$densities - fit2)
fit1 <- mod1$coefficients[1] + c(1:80) * mod1$coefficients[2]
fit2 <- mod2$coefficients[1] + c(1:80) * mod2$coefficients[2]
plot(outback_k3gmm$densities - fit1, type = "l")
lines(outback_k3gmm$densities - fit2)
par(mfrow = c(1, 2))
plot(outback_k3gmm$densities - fit1, type = "l")
plot(outback_k3gmm$densities - fit2, type = "l")
par(mfrow = c(1, 1))
mod1 <- lm(outback_k3gmm$densities[1:42] ~ c(1:42))
mod2 <- lm(outback_k3gmm$densities[43:80] ~ c(43:80))
fit1 <- mod1$coefficients[1] + c(1:80) * mod1$coefficients[2]
fit2 <- mod2$coefficients[1] + c(1:80) * mod2$coefficients[2]
par(mfrow = c(1, 2))
plot(outback_k3gmm$densities - fit1, type = "l")
length(fit1)
length(outback_k3gmm$densities)
mod1 <- lm(outcast_k3gmm$densities[1:42] ~ c(1:42))
mod2 <- lm(outcast_k3gmm$densities[43:80] ~ c(43:80))
fit1 <- mod1$coefficients[1] + c(1:80) * mod1$coefficients[2]
fit2 <- mod2$coefficients[1] + c(1:80) * mod2$coefficients[2]
par(mfrow = c(1, 2))
plot(outcast_k3gmm$densities - fit1, type = "l")
plot(outcast_k3gmm$densities - fit2, type = "l")
plot(outcast_k3gmm$densities, type = "l")
abline(mod1)
par(mfrow = c(1, 3))
plot(outcast_k3gmm$densities, type = "l")
abline(mod1)
abline(mod2)
plot(outcast_k3gmm$densities - fit1, type = "l")
plot(outcast_k3gmm$densities - fit2, type = "l")
length(outcast_k3gmm$densities)
outcast_k3gmm <- outcast_gmm(k3gmm[, -3], 3, 80)
mod1 <- lm(outcast_k3gmm$densities[1:42] ~ c(1:42))
mod2 <- lm(outcast_k3gmm$densities[43:80] ~ c(43:80))
fit1 <- mod1$coefficients[1] + c(1:80) * mod1$coefficients[2]
fit2 <- mod2$coefficients[1] + c(1:80) * mod2$coefficients[2]
par(mfrow = c(1, 3))
plot(outcast_k3gmm$densities, type = "l")
abline(mod1)
abline(mod2)
plot(outcast_k3gmm$densities - fit1, type = "l")
plot(outcast_k3gmm$densities - fit2, type = "l")
abs(outcast_k3gmm$densities - fit1) < abs(outcast_k3gmm$densities - fit2)
which(abs(outcast_k3gmm$densities - fit1) < abs(outcast_k3gmm$densities - fit2))
which(abs(outcast_k3gmm$densities - fit1) <= abs(outcast_k3gmm$densities - fit2))
changepoints <- 31:45
sd_factors <- seq(0.5, 5, 0.5)
outnums <- matrix(nrow = length(changepoints), ncol = length(sd_factors),
dimnames = list(changepoints, sd_factors))
for (i in seq_along(changepoints)) {
for (j in seq_along(sd_factors)) {
outnums[i, j] <- identify_outliers(
outback_k3gmm$densities,
changepoints[i],
sd_factors[j])$outlier_num
}
}
outnums
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 40)$choice, 1)$outlier_num
plot(outback_k3gmm$densities, type = "l")
par(mfrow = c(1, 1))
plot(outback_k3gmm$densities, type = "l")
abline(v = 40)
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 41)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 40)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 41)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 36)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 42)$choice, 1)$outlier_num
document()
check()
use_import_from("stats", "lm")
use_import_from("stats", "sd")
use_import_from("cpop", "cpop")
check()
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 36)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 35)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 34)$choice, 1)$outlier_num
identify_outliers(outback_k3gmm$densities, use_cpop(outback_k3gmm$densities, 33)$choice, 1)$outlier_num
?cpop
cpop1 <- use_cpop(outback_k3gmm$densities, 40)
cpop::residuals(cpop1)
cpop::residuals(cpop1$cpop_out)
load_all()
load_all()
cpop1 <- use_cpop(outback_k3gmm$densities, 40)
load_all()
cpop1 <- use_cpop(outback_k3gmm$densities, 40)
load_all()
cpop1 <- use_cpop(outback_k3gmm$densities, 40)
warnings()
left
y_len
length(left)
width
load_all()
cpop1 <- use_cpop(outback_k3gmm$densities, 40)
load_all()
cpop1 <- use_cpop(outback_k3gmm$densities, 40)
left
right
right - left
sd_vec
plot(sd_vec, type = "l")
lines(1:40, sd1)
length(sd1)
lines(1:40, rep(sd1, 40))
lines(41:80, rep(sd2, 40))
load_all()
use_cpop(outback_k3gmm$densities, 40)$choice
use_cpop(outback_k3gmm$densities, 39)$choice
use_cpop(outback_k3gmm$densities, 38)$choice
use_cpop(outback_k3gmm$densities, 35)$choice
use_cpop(outback_k3gmm$densities, 45)$choice
plot(outback_k3gmm$densities, type = "l")
abline(v = 41)
use_cpop(outcast_k3gmm$densities, 45)$choice
use_cpop(outcast_k3gmm$densities, 40)$choice
use_cpop(outcast_k3gmm$densities, 39)$choice
document()
abline(sd(cpop::residuals(outback_cpop$cpop_out)[1:40]))
abline(h = sd(cpop::residuals(outback_cpop$cpop_out)[1:40]))
abline(h = sd(cpop::residuals(outback_cpop$cpop_out)[41:80]))
sd(cpop::residuals(outback_cpop$cpop_out)[41:80])
sd(cpop::residuals(outback_cpop$cpop_out)[41:60])
abline(h = sd(cpop::residuals(outback_cpop$cpop_out)[41:60]))
load_all()
use_cpop(outcast_k3gmm$densities, 39)$choice
?outback_gmm
outcast_k3gmm <- outcast_gmm(k3gmm[, -3], 3, 80)
plot(outcast_k3gmm$densities, type = "l")
use_cpop(outcast_k3gmm$densities, 2)
use_cpop(outcast_k3gmm$densities, 3)
use_cpop(outcast_k3gmm$densities, 4)
use_cpop(outcast_k3gmm$densities, 5)
use_cpop(outcast_k3gmm$densities, 6)
use_cpop(outcast_k3gmm$densities, 7)
use_cpop(outcast_k3gmm$densities, 8)
use_cpop(outcast_k3gmm$densities, 9)
use_cpop(outcast_k3gmm$densities, 10)
use_cpop(outcast_k3gmm$densities, 11)
use_cpop(outcast_k3gmm$densities, 12)
use_cpop(outcast_k3gmm$densities, 13)
use_cpop(outcast_k3gmm$densities, 20)
use_cpop(outcast_k3gmm$densities, 15)
use_cpop(outcast_k3gmm$densities, 17)
use_cpop(outcast_k3gmm$densities, 16)
use_cpop(outcast_k3gmm$densities, 18)
use_cpop(outcast_k3gmm$densities, 19)
use_cpop(outcast_k3gmm$densities, 20)
load_all()
use_cpop(outcast_k3gmm$densities, 19)
use_cpop(outcast_k3gmm$densities, 15)
use_cpop(outcast_k3gmm$densities, 3)
use_cpop(outcast_k3gmm$densities, 2)
use_cpop(outcast_k3gmm$densities, 1)
use_cpop(outcast_k3gmm$densities, 3)
use_cpop(outcast_k3gmm$densities, 4)
use_cpop(outcast_k3gmm$densities, 5)
y <- outcast_k3gmm$densities
cpop::cpop(
outcast_k3gmm$densities, seq_len(80),
grid = 1:22, minseglen = 22
)
cpop::cpop(
outcast_k3gmm$densities, seq_len(80),
grid = 1:22, minseglen = 23
)
cpop::cpop(
outcast_k3gmm$densities, seq_len(80),
grid = 1:22, minseglen = 10
)
load_all()
use_cpop(outcast_k3gmm$densities, 5)
search_radius
use_cpop(outcast_k3gmm$densities, 4)
search_radius
load_all()
use_cpop(outcast_k3gmm$densities, 4)
load_all()
use_cpop(outcast_k3gmm$densities, 4)
use_cpop(outcast_k3gmm$densities, 76)
use_cpop(outcast_k3gmm$densities, 77)
load_all()
use_cpop(outcast_k3gmm$densities, 77)
use_cpop(outcast_k3gmm$densities, 77)$choice
use_cpop(outcast_k3gmm$densities, 6)$choice
use_cpop(outcast_k3gmm$densities, 7)$choice
load_all()
use_cpop(outcast_k3gmm$densities, 40)
load_all()
use_cpop(outcast_k3gmm$densities, 40)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), aes(x = x, y = y)) +
geom_line()
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot::aes(x = x, y = y)) +
geom_line()
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line()
gg <- ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::annotate("vline", xintercept = choice)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::annotate("vline", xintercept = choice)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::geom_vline(xintercept = choice)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::geom_vline(xintercept = search_interval)
ggplot2::geom_vline(xintercept = choice)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::geom_vline(xintercept = search_interval, linetype = "dashed") +
ggplot2::geom_vline(xintercept = choice)
load_all()
use_cpop(outcast_k3gmm$densities, 40)
use_cpop(outcast_k3gmm$densities, 40)
ultan <- use_cpop(outcast_k3gmm$densities, 40)
ultan$plot
load_all()
use_cpop(outcast_k3gmm$densities, 40)
load_all()
use_cpop(outcast_k3gmm$densities, 40)
load_all()
use_cpop(outcast_k3gmm$densities, 40)
library(devtools)
load_all()
gmm <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(c(-1, 0), c(+1, -1), c(+1, +1)),
sigma = list(diag(c(0.2, 4 * 0.2)), diag(c(0.2, 0.2)), diag(c(0.2, 0.2))),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
k3gmm <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(c(-1, 0), c(+1, -1), c(+1, +1)),
sigma = list(diag(c(0.2, 4 * 0.2)), diag(c(0.2, 0.2)), diag(c(0.2, 0.2))),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
outcast_k3gmm <- outcast_gmm(k3gmm[, -3], 3, 80)
ultan <- use_cpop(outcast_k3gmm$densities, 40)
attr(ultan)
attributes(ultan)
attributes(ultan$cpop_out)
str(ultan$cpop_out)
ultan$cpop_out
unclass(ultan$cpop_out)
?print
class(ultan$cpop_out)
cpop::`.__T__summary:base`
?cpop::`.__T__summary:base`
cpop::summary()
cpop::summary(ultan$cpop_out)
ultan2 <- cpop::summary(ultan$cpop_out)
str(ultan2)
unclass(ultan2)
cpop::summary
broom::tidy(ultan2)
broom::tidy(ultan)
names(summary(ultan))
summary(ultan)
ultan <- use_cpop(outcast_k3gmm$densities, 40)
summary(ultan)
ultan
cpop::fitted(ultan)
cpop::fitted(ultan$cpop_out)
ultan2 <- cpop::fitted(ultan$cpop_out)
str(ultan2)
ultan2$gradient
load_all()
use_cpop(outcast_k3gmm$densities, 40)
check()
load_all()
use_cpop(outcast_k3gmm$densities, 40)
use_package("ggplot2")
document()
check()
devtools::create("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outcast")
document()
check()
document()
