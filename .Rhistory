use_cpop(outcast_k3gmm$densities, 17)
use_cpop(outcast_k3gmm$densities, 16)
use_cpop(outcast_k3gmm$densities, 18)
use_cpop(outcast_k3gmm$densities, 19)
use_cpop(outcast_k3gmm$densities, 20)
load_all()
use_cpop(outcast_k3gmm$densities, 19)
use_cpop(outcast_k3gmm$densities, 15)
use_cpop(outcast_k3gmm$densities, 3)
use_cpop(outcast_k3gmm$densities, 2)
use_cpop(outcast_k3gmm$densities, 1)
use_cpop(outcast_k3gmm$densities, 3)
use_cpop(outcast_k3gmm$densities, 4)
use_cpop(outcast_k3gmm$densities, 5)
y <- outcast_k3gmm$densities
cpop::cpop(
outcast_k3gmm$densities, seq_len(80),
grid = 1:22, minseglen = 22
)
cpop::cpop(
outcast_k3gmm$densities, seq_len(80),
grid = 1:22, minseglen = 23
)
cpop::cpop(
outcast_k3gmm$densities, seq_len(80),
grid = 1:22, minseglen = 10
)
load_all()
use_cpop(outcast_k3gmm$densities, 5)
search_radius
use_cpop(outcast_k3gmm$densities, 4)
search_radius
load_all()
use_cpop(outcast_k3gmm$densities, 4)
load_all()
use_cpop(outcast_k3gmm$densities, 4)
use_cpop(outcast_k3gmm$densities, 76)
use_cpop(outcast_k3gmm$densities, 77)
load_all()
use_cpop(outcast_k3gmm$densities, 77)
use_cpop(outcast_k3gmm$densities, 77)$choice
use_cpop(outcast_k3gmm$densities, 6)$choice
use_cpop(outcast_k3gmm$densities, 7)$choice
load_all()
use_cpop(outcast_k3gmm$densities, 40)
load_all()
use_cpop(outcast_k3gmm$densities, 40)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), aes(x = x, y = y)) +
geom_line()
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot::aes(x = x, y = y)) +
geom_line()
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line()
gg <- ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::annotate("vline", xintercept = choice)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::annotate("vline", xintercept = choice)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::geom_vline(xintercept = choice)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::geom_vline(xintercept = search_interval)
ggplot2::geom_vline(xintercept = choice)
ggplot2::ggplot(cbind(x = seq_len(y_len), y = y), ggplot2::aes(x = x, y = y)) +
ggplot2::geom_line() +
ggplot2::geom_vline(xintercept = search_interval, linetype = "dashed") +
ggplot2::geom_vline(xintercept = choice)
load_all()
use_cpop(outcast_k3gmm$densities, 40)
use_cpop(outcast_k3gmm$densities, 40)
ultan <- use_cpop(outcast_k3gmm$densities, 40)
ultan$plot
load_all()
use_cpop(outcast_k3gmm$densities, 40)
load_all()
use_cpop(outcast_k3gmm$densities, 40)
load_all()
use_cpop(outcast_k3gmm$densities, 40)
library(devtools)
load_all()
gmm <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(c(-1, 0), c(+1, -1), c(+1, +1)),
sigma = list(diag(c(0.2, 4 * 0.2)), diag(c(0.2, 0.2)), diag(c(0.2, 0.2))),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
k3gmm <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(c(-1, 0), c(+1, -1), c(+1, +1)),
sigma = list(diag(c(0.2, 4 * 0.2)), diag(c(0.2, 0.2)), diag(c(0.2, 0.2))),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
outcast_k3gmm <- outcast_gmm(k3gmm[, -3], 3, 80)
ultan <- use_cpop(outcast_k3gmm$densities, 40)
attr(ultan)
attributes(ultan)
attributes(ultan$cpop_out)
str(ultan$cpop_out)
ultan$cpop_out
unclass(ultan$cpop_out)
?print
class(ultan$cpop_out)
cpop::`.__T__summary:base`
?cpop::`.__T__summary:base`
cpop::summary()
cpop::summary(ultan$cpop_out)
ultan2 <- cpop::summary(ultan$cpop_out)
str(ultan2)
unclass(ultan2)
cpop::summary
broom::tidy(ultan2)
broom::tidy(ultan)
names(summary(ultan))
summary(ultan)
ultan <- use_cpop(outcast_k3gmm$densities, 40)
summary(ultan)
ultan
cpop::fitted(ultan)
cpop::fitted(ultan$cpop_out)
ultan2 <- cpop::fitted(ultan$cpop_out)
str(ultan2)
ultan2$gradient
load_all()
use_cpop(outcast_k3gmm$densities, 40)
check()
load_all()
use_cpop(outcast_k3gmm$densities, 40)
use_package("ggplot2")
document()
check()
devtools::create("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outcast")
document()
check()
document()
library(devtools)
load_all()
document()
document()
check()
document()
check()
?stats::mahalanobis
matrix(c(1, 2, 3, 4))
matrix(c(1, 2, 3, 4), 2, 2)
c(matrix(c(1, 2, 3, 4), 2, 2))
?sweep
?c
?as.vector
?qbeta
?quantile
load_all()
library(devtools)
load_all()
gmm <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(c(-1, 0), c(+1, -1), c(+1, +1)),
sigma = list(diag(c(0.2, 4 * 0.2)), diag(c(0.2, 0.2)), diag(c(0.2, 0.2))),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
betamix_diff
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
matplot(ombc_gmm$distrib_diff_mat, type = "l")
plot(ombc_gmm$betamix_diff)
plot(ombc_gmm$betamix_diff, type = "l")
ombc_gmm$betamix_diff
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
matplot(ombc_gmm$distrib_diff_mat, type = "l")
plot(ombc_gmm$betamix_diff, type = "l")
matplot(ombc_gmm$distrib_diff_mat, type = "l")
lines(ombc_gmm$betamix_diff)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
plot(density(betamix_cdf_vals))
plot(density(mahala_ewcdf_vals))
?quantile
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
plot(density(betamix_cdf_vals))
plot(betamix_cdf_vals)
plot(betamix_cdf_vals, type = "l")
plot(checkpoints, betamix_cdf_vals, type = "l")
plot(checkpoints, mahala_ewcdf_vals, type = "l")
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
checkpoints
plot(checkpoints)
hist(checkpoints)
hist(checkpoints, breaks = 100)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
plot(checkpoints, betamix_cdf_vals, type = "l")
plot(checkpoints, mahala_ewcdf_vals, type = "l")
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
matplot(ombc_gmm$distrib_diff_mat, type = "l")
lines(ombc_gmm$betamix_diff)
min(ombc_gmm$betamix_diff)
which.min(ombc_gmm$betamix_diff)
plot(gmm[, 1:2], col = gmm$G)
plot(gmm[, 1:2], col = gmm$G + 1)
plot(ombc_gmm$distrib_diff_mat[, 1] + ombc_gmm$betamix_diff)
plot(ombc_gmm$distrib_diff_mat[, 1] + ombc_gmm$betamix_diff, type = "l")
plot(scale(ombc_gmm$distrib_diff_mat[, 1]) + scale(ombc_gmm$betamix_diff), type = "l")
?scale
plot(ombc_gmm$distrib_diff_mat[, 1], type = "l"
)
plot(scale(ombc_gmm$distrib_diff_mat[, 3]) + scale(ombc_gmm$betamix_diff), type = "l")
plot(scale(ombc_gmm$distrib_diff_mat[, 2]) + scale(ombc_gmm$betamix_diff), type = "l")
plot(scale(ombc_gmm$distrib_diff_mat[, 1]) + scale(ombc_gmm$betamix_diff), type = "l")
plot(scale(ombc_gmm$distrib_diff_mat[, 4]) + scale(ombc_gmm$betamix_diff), type = "l")
ombc_gmm$outlier_num
which.min(scale(ombc_gmm$distrib_diff_mat[, 3]) + scale(ombc_gmm$betamix_diff))
plot(scale(ombc_gmm$distrib_diff_mat[, 3]) + scale(ombc_gmm$betamix_diff), type = "l")
plot(ombc_gmm$betamix_diff)
plot(ombc_gmm$betamix_diff, type = "l")
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos/s1"
)
s1 <- read.table(paste0(folder, "/s1.txt"))
ombc_s1_123m1000_time <- system.time({
ombc_s1_123m1000 <- ombc_gmm(
x = s1,
comp_num = 15,
max_out = 1000,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
})
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos/s1"
)
s1n <- read.table(paste0(folder, "/s1n.txt"))
ombc_s1n_123m500_time <- system.time({
ombc_s1n_123m500 <- ombc_gmm(
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
})
matplot(ombc_s1n_123m500$distrib_diff_mat, type = "l")
lines(ombc_s1n_123m500$betamix_diff)
?stats::cutree
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
?dist
dist(iris[, -5])
ultan <- dist(iris[, -5])
str(ultan)
str(ultan[1])
str(ultan[[1]])
attr(ultan, "Size")
ultan <- as.matrix(ultan)
hclust(ultan)
hclust(as.dist(ultan))
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
matplot(ombc_gmm$distrib_diff_mat, type = "l")
lines(ombc_gmm$betamix_diff)
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80, reinit_freq = 10)
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80, reinit_interval = 10)
matplot(ombc_gmm$distrib_diff_mat, type = "l")
lines(ombc_gmm$betamix_diff)
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos/s1"
)
s1n <- read.table(paste0(folder, "/s1n.txt"))
ombc_s1n_123m500_time <- system.time({
ombc_s1n_123m500 <- ombc_gmm(
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
})
matplot(ombc_s1n_123m500$distrib_diff_mat)
matplot(ombc_s1n_123m500$distrib_diff_mat, type = "l")
plot(ombc_s1n_123m500$betamix_diff)
plot(ombc_s1n_123m500$betamix_diff, type = "l")
library(devtools)
load_all()
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos/s1"
)
s1n <- read.table(paste0(folder, "/s1n.txt"))
ombc_s1n_123m500_time <- system.time({
ombc_s1n_123m500 <- ombc_gmm(
x = s1n,
comp_num = 15,
max_out = 500,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
})
plot(ombc_s1n_123m500$betamix_diff, type = "l")
which.min(ombc_s1n_123m500$betamix_diff)
matplot(ombc_s1n_123m500$distrib_diff_mat)
matplot(ombc_s1n_123m500$distrib_diff_mat, type = "l")
plot(ombc_s1n_123m500$betamix_diff, type = "l")
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming",
"/outlierMBC_demos/s1"
)
s1 <- read.table(paste0(folder, "/s1.txt"))
ombc_s1_123m1000_time <- system.time({
ombc_s1_123m1000 <- ombc_gmm(
x = s1,
comp_num = 15,
max_out = 1000,
mnames = "VVV",
seed = 123,
reinit_interval = 10,
print_interval = 10
)
})
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
gmm <- simulate_gmm(
n = c(2000, 1000, 1000),
mu = list(c(-1, 0), c(+1, -1), c(+1, +1)),
sigma = list(diag(c(0.2, 4 * 0.2)), diag(c(0.2, 0.2)), diag(c(0.2, 0.2))),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
ombc_gmm$distrib_diff_mat[, 5]
ombc_gmm$distrib_diff_mat[, 5] - ombc_gmm$betamix_diff
which.min(ombc_gmm$betamix_diff)
ombc_gmm$outlier_num
matplot(ombc_gmm$distrib_diff_mat, type = "l")
matplot(ombc_gmm$distrib_diff_mat[, 1], type = "l")
matplot(ombc_gmm$distrib_diff_mat[, 2], type = "l")
matplot(ombc_gmm$distrib_diff_mat[, 3], type = "l")
matplot(ombc_gmm$distrib_diff_mat[, 4], type = "l")
plot(ombc_gmm$betamix_diff, type = "l")
plot(gmm[, 1:2], col = ombc_gmm$outlier_bool[, 5] + 1)
load_all()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
ombc_gmm$outlier_num
plot(gmm[, 1:2], col = ombc_gmm$labels[, 5])
plot(gmm[, 1:2], col = ombc_gmm$labels[, 5] + 1)
plot(gmm[, 1:2], col = ombc_gmm$labels[, 5] + 1, pch = gmm$G + 1)
load_all()
document()
check()
use_import_from("stats", "dist")
use_import_from("stats", "as.dist")
check()
check()
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
ombc_gmm$outlier_num
matplot(ombc_gmm$distrib_diff_mat[, 1], type = "l")
matplot(ombc_gmm$distrib_diff_mat[, 2], type = "l")
matplot(ombc_gmm$distrib_diff_mat[, 3], type = "l")
matplot(ombc_gmm$distrib_diff_mat[, 4], type = "l")
gmm <- simulate_gmm(
n = c(200, 100, 100),
mu = list(c(-1, 0), c(+1, -1), c(+1, +1)),
sigma = list(diag(c(0.2, 4 * 0.2)), diag(c(0.2, 0.2)), diag(c(0.2, 0.2))),
outlier_num = 40,
seed = 123,
crit_val = 0.9999,
range_multiplier = 1.5
)
ombc_gmm <- ombc_gmm(gmm[, 1:2], comp_num = 3, max_out = 80)
ombc_gmm$outlier_num
matplot(ombc_gmm$distrib_diff_mat[, 1], type = "l")
matplot(ombc_gmm$distrib_diff_mat[, 2], type = "l")
matplot(ombc_gmm$distrib_diff_mat[, 3], type = "l")
matplot(ombc_gmm$distrib_diff_mat[, 4], type = "l")
plot(ombc_gmm$betamix_diff, type = "l")
matplot(ombc_gmm$distrib_diff_mat[, 5], type = "l")
abline(v = ombc_gmm$outlier_num[5])
dim(ombc_gmm$distrib_diff_mat)
matplot(0:80, ombc_gmm$distrib_diff_mat[, 1], type = "l")
matplot(0:80, ombc_gmm$distrib_diff_mat[, 1], type = "l")
matplot(0:80, ombc_gmm$distrib_diff_mat[, 2], type = "l")
matplot(0:80, ombc_gmm$distrib_diff_mat[, 3], type = "l")
matplot(0:80, ombc_gmm$distrib_diff_mat[, 4], type = "l")
matplot(0:80, ombc_gmm$distrib_diff_mat[, 5], type = "l")
document()
ombc_gmm$outlier_num
ombc_s1n <- readRDS("C:\Users\Administrator\Desktop\ombc_s1n_seed1m500r1.rds)
ombc_s1n <- readRDS("C:/Users/Administrator/Desktop/ombc_s1n_seed1m500r1.rds)
ombc_s1n <- readRDS("C:/Users/Administrator/Desktop/ombc_s1n_seed1m500r1.rds")
ombc_s1n$outlier_num
plot(ombc_s1n$distrib_diff_mat[, 5], type = "l")
gt_v10b50_miscl <-
gt_v10bF_miscl <-
gt_v100b50_miscl <-
zero_labs_miscl <-
matrix(nrow = length(seeds) * length(small_prop), ncol = 3,
dimnames = list(NULL, c("miscl_rate", "small_prop", "seed")))
index <- 1
for (i in seq_along(small_prop)) {
for (j in seq_along(seeds)) {
gt_v10b50_miscl[index, 1] <-
mean(comp_labs[[i]] != gt_v10b50[[i]][[j]]$labels)
gt_v10bF_miscl[index, 1] <-
mean(comp_labs[[i]] != gt_v10bF[[i]][[j]]$labels)
gt_v100b50_miscl[index, 1] <-
mean(comp_labs[[i]] != gt_v100b50[[i]][[j]]$labels)
zero_labs_miscl[index, 1] <-
mean(comp_labs[[i]] != zero_labs[[i]][[j]])
gt_v10b50_miscl[index, 2] <-
gt_v10bF_miscl[index, 2] <-
gt_v100b50_miscl[index, 2] <-
zero_labs_miscl[index, 2] <-
small_prop[i]
gt_v10b50_miscl[index, 3] <-
gt_v10bF_miscl[index, 3] <-
gt_v100b50_miscl[index, 3] <-
zero_labs_miscl[index, 3] <-
seeds[j]
index <- index + 1
}
}
miscl_rate <- bind_rows(
bind_cols(gt_v10b50_miscl, method = "gt_v10b50"),
bind_cols(gt_v100b50_miscl, method = "gt_v100b50"),
bind_cols(gt_v10bF_miscl, method = "gt_v10bF"),
bind_cols(zero_labs_miscl, method = "zero_labs")
)
library(tidyverse)
phenograph <- reticulate::import("phenograph")
wd <- paste0("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD",
"/Programming/gateTree_demos/Simulation2")
source(paste0(wd, "/zero_splitter.R"))
var_num <- 2
source(paste0("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD",
"/Programming/gateTree_demos/Simulation2/1_specify_settings.R"))
plusminus <- rbind(c(-1, 0),
c(+1, -1),
c(+1, +1))
colnames(plusminus) <- as.character(seq_len(var_num))
rownames(plusminus) <- as.character(seq_len(comp_num))
params <- list()
for (i in seq_along(small_prop)) {
params[[i]] <- list()
params[[i]][[1]]       <- list()
params[[i]][[1]]$n     <- big_n[i]
params[[i]][[1]]$mu    <- plusminus[1, ]
params[[i]][[1]]$Sigma <- diag(c(var_pm, var_0))
params[[i]][[2]]       <- list()
params[[i]][[2]]$n     <- small_n[i]
params[[i]][[2]]$mu    <- plusminus[2, ]
params[[i]][[2]]$Sigma <- diag(c(var_pm, var_pm))
params[[i]][[3]]       <- list()
params[[i]][[3]]$n     <- small_n[i]
params[[i]][[3]]$mu    <- plusminus[3, ]
params[[i]][[3]]$Sigma <- diag(c(var_pm, var_pm))
}
source(paste0("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD",
"/Programming/gateTree_demos/Simulation2/2_simulate_samples.R"))
source(paste0("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD",
"/Programming/gateTree_demos/Simulation2/3_cluster_samples.R"))
source(paste0("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD",
"/Programming/gateTree_demos/Simulation2/4_evaluate_clusters.R"))
f1 |> print(n = Inf)
f1 |>
filter(method %in% c("cytometree0.0001", "cytometree0.0010",
"cytometree0.0100","cytometree0.1000",
"gt_v10b50", "gt_v10bF", "gt_v100b50")) |>
print(n = Inf)
f1 |>
filter(method %in% c("cytometree0.0001",
"gt_v10bF", "gt_v100b50")) |>
print(n = Inf)
