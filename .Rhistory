library(devtools)
document()
check()
check()
remotes::install_github("UltanPDoherty/outlierMBC")
ombc_backup1e4_noisy_s1 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_backup1e4_noisy_s1.rds")
ombc_backup1e4_noisy_s2 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_backup1e4_noisy_s2.rds")
ombc_backup1e4reuse0_noisy_s1 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_backup1e4reuse0_noisy_s1.rds")
ombc_backup1e4reuse0_noisy_s2 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_backup1e4reuse0_noisy_s2.rds")
library(outlierMBC)
plot_full_curve(ombc_backup1e4_noisy_s1)
plot_tail_curve(ombc_backup1e4_noisy_s1)
plot_full_curve(ombc_backup1e4reuse0_noisy_s1)
plot_tail_curve(ombc_backup1e4reuse0_noisy_s1)
plot_tail_curve(ombc_backup1e4_noisy_s2)
plot_full_curve(ombc_backup1e4_noisy_s2)
plot_full_curve(ombc_backup1e4reuse0_noisy_s1)
plot_full_curve(ombc_backup1e4reuse0_noisy_s2)
plot_tail_curve(ombc_backup1e4reuse0_noisy_s2)
ombc_backup1e4_noisy_s3 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_backup1e4_noisy_s3.rds")
ombc_backup1e4reuse0_noisy_s3 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_backup1e4reuse0_noisy_s3.rds")
plot_full_curve(ombc_backup1e4reuse0_noisy_s3)
plot_full_curve(ombc_backup1e4_noisy_s3)
plot_tail_curve(ombc_backup1e4_noisy_s3)
plot_tail_curve(ombc_backup1e4reuse0_noisy_s3)
ombc_backup1e4_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_backup1e4_noisy_s4.rds")
ombc_backup1e4reuse0_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_backup1e4reuse0_noisy_s4.rds")
plot_full_curve(ombc_backup1e4_noisy_s4)
plot_full_curve(ombc_backup1e4reuse0_noisy_s4)
plot_tail_curve(ombc_backup1e4_noisy_s4)
plot_tail_curve(ombc_backup1e4reuse0_noisy_s4)
table(ombc_backup1e4_noisy_s4$conv_status)
ombc_update1e4_noisy_s3 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_update1e4_noisy_s3.rds")
plot_full_curve(ombc_update1e4_noisy_s3)
plot_full_curve(ombc_backup1e4_noisy_s3)
plot_full_curve(ombc_update1e4_noisy_s4)
ombc_update1e4_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_update1e4_noisy_s4.rds")
plot_full_curve(ombc_update1e4_noisy_s4)
plot_full_curve(ombc_backup1e4_noisy_s4)
ombc_backup1e4_noisy_s4$distrib_diff_mat[1, ]
table(ombc_backup1e4_noisy_s4$z_backup)
plot(ombc_backup1e4_noisy_s4$distrib_diff_mat[, "full"], col = ombc_backup1e4_noisy_s4$z_backup)
plot(ombc_backup1e4_noisy_s4$distrib_diff_mat[, "full"], col = ombc_backup1e4_noisy_s4$z_backup + 1)
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD",
"/Programming/outlierMBC_demos/uef_sipu_data/outlier_datasets"
)
noisy_s4 <- read.table(paste0(folder, "/noisy/noisy_s4.txt"))
plot(noisy_s4, col = ombc_backup1e4_noisy_s4$outlier_rank == 2)
plot(noisy_s4, col = ombc_backup1e4_noisy_s4$outlier_rank == 251)
plot(noisy_s4, col = 1 + (ombc_backup1e4_noisy_s4$outlier_rank == 251))
plot(noisy_s4, col = 1 + (ombc_backup1e4_noisy_s4$outlier_rank == 250))
sum(ombc_backup1e4_noisy_s4$outlier_rank == 250)
plot(noisy_s4, col = 1 + (ombc_backup1e4_noisy_s4$outlier_rank == 251))
plot(noisy_s4[!ombc_backup1e4_noisy_s4$gross_outs, ], col = 1 + (ombc_backup1e4_noisy_s4$outlier_rank[!ombc_backup1e4_noisy_s4$gross_outs] == 251))
head(ombc_backup1e4_noisy_s4$z_backup)
plot_full_curve(ombc_update1e4_noisy_s4)
ombc_reinit1e4_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_reinit1e4_noisy_s4.rds")
plot_full_curve(ombc_reinit1e4_noisy_s4)
diff(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"])
which.min(diff(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"]))
plot(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"])
abline(v = 19)
plot(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"], type = "l")
abline(v = 19)
abline(v = 20)
min(diff(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"]))
min(diff(ombc_reinit1e4_noisy_s4$loglike))
hist(diff(ombc_reinit1e4_noisy_s4$loglike))
table(hist(diff(ombc_reinit1e4_noisy_s4$loglike)))
hist(diff(ombc_reinit1e4_noisy_s4$loglike))
?hist
hist(diff(ombc_reinit1e4_noisy_s4$loglike), plot = F)
ombc_reinit1e4_noisy_s4$loglike / lag(ombc_reinit1e4_noisy_s4)
ombc_reinit1e4_noisy_s4$loglike / lag(ombc_reinit1e4_noisy_s4$loglike)
z_backup[i] <- TRUE
lag(ombc_reinit1e4_noisy_s4$loglike)
ombc_reinit1e4_noisy_s4$loglike
?lag
lag(ombc_reinit1e4_noisy_s4$loglike, n = 1)
lag(1:5, 1)
dplyr::lag(1:5, 1)
ombc_reinit1e4_noisy_s4$loglike / dplyr::lag(ombc_reinit1e4_noisy_s4$loglike)
plot_full_curve(ombc_reinit1e4_noisy_s4)
folder <- paste0(
"C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD",
"/Programming/outlierMBC_demos/uef_sipu_data/outlier_datasets"
)
library(tidyverse)
noisy_s4 <- read.table(paste0(folder, "/noisy/noisy_s4.txt"))
ombc_update1e4_noisy_s1 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_update1e4_noisy_s1.rds")
ombc_update1e4_noisy_s2 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_update1e4_noisy_s2.rds")
ombc_update1e4_noisy_s3 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_update1e4_noisy_s3.rds")
ombc_update1e4_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_update1e4_noisy_s4.rds")
plot(ombc_update1e4_noisy_s1$loglike + cumsum(log(ombc_update1e4_noisy_s1$removal_dens)))
plot(x = seq(sum(ombc_update1e4_noisy_s1$gross_outs), 500), y = ombc_update1e4_noisy_s1$loglike + cumsum(log(ombc_update1e4_noisy_s1$removal_dens)))
sum(ombc_update1e4_noisy_s1$gross_outs)
plot(x = seq(sum(ombc_update1e4_noisy_s1$gross_outs), 500), y = ombc_update1e4_noisy_s1$loglike + cumsum(log(ombc_update1e4_noisy_s1$removal_dens)), type = "b")
plot(x = seq(sum(ombc_update1e4_noisy_s1$gross_outs), 500), y = ombc_update1e4_noisy_s1$loglike + cumsum(log(ombc_update1e4_noisy_s1$removal_dens)), type = "b", pch = 20)
par(mfrow = c(2, 2))
plot(ombc_update1e4_noisy_s1$loglike + cumsum(log(ombc_update1e4_noisy_s1$removal_dens)), type = "l")
plot(ombc_update1e4_noisy_s2$loglike + cumsum(log(ombc_update1e4_noisy_s2$removal_dens)), type = "l")
plot(ombc_update1e4_noisy_s3$loglike + cumsum(log(ombc_update1e4_noisy_s3$removal_dens)), type = "l")
plot(ombc_update1e4_noisy_s4$loglike + cumsum(log(ombc_update1e4_noisy_s4$removal_dens)), type = "l")
par(mfrow = c(2, 2))
plot(
x = seq(sum(ombc_update1e4_noisy_s1$gross_outs), 500),
y = ombc_update1e4_noisy_s1$loglike +
cumsum(log(ombc_update1e4_noisy_s1$removal_dens)),
type = "b", pch = 20
)
par(mfrow = c(2, 2))
plot(
x = seq(sum(ombc_update1e4_noisy_s1$gross_outs), 500),
y = ombc_update1e4_noisy_s1$loglike +
cumsum(log(ombc_update1e4_noisy_s1$removal_dens)),
type = "b", pch = 20
)
plot(
x = seq(sum(ombc_update1e4_noisy_s2$gross_outs), 500),
y = ombc_update1e4_noisy_s2$loglike +
cumsum(log(ombc_update1e4_noisy_s2$removal_dens)),
type = "b", pch = 20
)
plot(
x = seq(sum(ombc_update1e4_noisy_s3$gross_outs), 500),
y = ombc_update1e4_noisy_s3$loglike +
cumsum(log(ombc_update1e4_noisy_s3$removal_dens)),
type = "b", pch = 20
)
plot(
x = seq(sum(ombc_update1e4_noisy_s4$gross_outs), 500),
y = ombc_update1e4_noisy_s4$loglike +
cumsum(log(ombc_update1e4_noisy_s4$removal_dens)),
type = "b", pch = 20
)
plot(
x = seq(sum(ombc_update1e4_noisy_s1$gross_outs), 500),
y = ombc_update1e4_noisy_s1$loglike +
cumsum(log(ombc_update1e4_noisy_s1$removal_dens)),
type = "b", pch = 20
)
abline(v = 275)
abline(v = 273)
plot(
x = seq(sum(ombc_update1e4_noisy_s2$gross_outs), 500),
y = ombc_update1e4_noisy_s2$loglike +
cumsum(log(ombc_update1e4_noisy_s2$removal_dens)),
type = "b", pch = 20
)
abline(v = 265)
abline(v = 263)
plot(
x = seq(sum(ombc_update1e4_noisy_s3$gross_outs), 500),
y = ombc_update1e4_noisy_s3$loglike +
cumsum(log(ombc_update1e4_noisy_s3$removal_dens)),
type = "b", pch = 20
)
abline(v = 253)
abline(v = 251)
plot(
x = seq(sum(ombc_update1e4_noisy_s4$gross_outs), 500),
y = ombc_update1e4_noisy_s4$loglike +
cumsum(log(ombc_update1e4_noisy_s4$removal_dens)),
type = "b", pch = 20
)
abline(v = 257)
abline(v = 256)
par(mfrow = c(2, 2))
plot(
x = seq(sum(ombc_update1e4_noisy_s1$gross_outs), 500),
y = ombc_update1e4_noisy_s1$loglike +
cumsum(log(ombc_update1e4_noisy_s1$removal_dens)),
type = "b", pch = 20
)
abline(v = 273)
plot(
x = seq(sum(ombc_update1e4_noisy_s2$gross_outs), 500),
y = ombc_update1e4_noisy_s2$loglike +
cumsum(log(ombc_update1e4_noisy_s2$removal_dens)),
type = "b", pch = 20
)
abline(v = 263)
plot(
x = seq(sum(ombc_update1e4_noisy_s3$gross_outs), 500),
y = ombc_update1e4_noisy_s3$loglike +
cumsum(log(ombc_update1e4_noisy_s3$removal_dens)),
type = "b", pch = 20
)
abline(v = 251)
plot(
x = seq(sum(ombc_update1e4_noisy_s4$gross_outs), 500),
y = ombc_update1e4_noisy_s4$loglike +
cumsum(log(ombc_update1e4_noisy_s4$removal_dens)),
type = "b", pch = 20
)
abline(v = 256)
par(mfrow = c(1, 1))
plot(
x = seq(257, 500),
y = ombc_update1e4_noisy_s4$loglike +
cumsum(log(ombc_update1e4_noisy_s4$removal_dens)),
type = "b", pch = 20
)
seq(sum(ombc_update1e4_noisy_s4$gross_outs), 500)
plot(
x = seq(sum(ombc_update1e4_noisy_s4$gross_outs), 500)[7:251],
y = (ombc_update1e4_noisy_s4$loglike +
cumsum(log(ombc_update1e4_noisy_s4$removal_dens)))[7:251],
type = "b", pch = 20
)
ombc_reinit1e4reuse1e4_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_reinit1e4reuse1e4_noisy_s4.rds")
ombc_reinit1e2reuse1e4_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_reinit1e2reuse1e4_noisy_s4.rds")
ombc_reinit1e2_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_reinit1e2_noisy_s4.rds")
ombc_reinit1e4_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_reinit1e4_noisy_s4.rds")
library(outlierMBC)
plot_full_curve(ombc_reinit1e4_noisy_s4)
plot_tail_curve(ombc_reinit1e4_noisy_s4)
plot_full_curve(ombc_reinit1e4reuse1e4_noisy_s4)
plot_tail_curve(ombc_reinit1e4reuse1e4_noisy_s4)
table(noisy_s4_label, ombc_reinit1e4reuse1e4_noisy_s4$outlier_bool$full)
noisy_s4_label <- read.table(paste0(folder, "/noisy/noisy_s4_label.txt"))[, 1]
table(noisy_s4_label, ombc_reinit1e4reuse1e4_noisy_s4$outlier_bool$full)
table(noisy_s4_label == 0, ombc_reinit1e4reuse1e4_noisy_s4$outlier_bool$full)
table(noisy_s4_label == 0, ombc_reinit1e4_noisy_s4$outlier_bool$full)
plot_full_curve(ombc_reinit1e2_noisy_s4)
plot_tail_curve(ombc_reinit1e2_noisy_s4)
plot_full_curve(ombc_reinit1e2reuse1e4_noisy_s4)
plot_tail_curve(ombc_reinit1e2reuse1e4_noisy_s4)
plot_tail_curve(ombc_reinit1e4reuse1e4_noisy_s4)
plot_full_curve(ombc_reinit1e4reuse1e4_noisy_s4)
plot_full_curve(ombc_reinit1e4reuse1e4_noisy_s4) + geom_vline(xintercept = 291)
plot_full_curve(ombc_reinit1e4reuse1e4_noisy_s4) + geom_vline(xintercept = 285)
plot_full_curve(ombc_reinit1e4reuse1e4_noisy_s4) + geom_vline(xintercept = 283)
plot_full_curve(ombc_reinit1e4_noisy_s4)
plot_full_curve(ombc_reinit1e4_noisy_s4) + geom_vline(xintercept = 283)
plot_full_curve(ombc_reinit1e4_noisy_s4) + geom_vline(xintercept = 284)
plot_full_curve(ombc_reinit1e4_noisy_s4) + geom_vline(xintercept = 274)
plot_full_curve(ombc_reinit1e4_noisy_s4) + geom_vline(xintercept = 264)
plot_full_curve(ombc_reinit1e4_noisy_s4) + geom_vline(xintercept = 270)
plot_full_curve(ombc_reinit1e4_noisy_s4) + geom_vline(xintercept = 269)
mean(diff(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"]))
plot_full_curve(ombc_reinit1e4reuse1e4_noisy_s4)
plot_full_curve(ombc_reinit1e4reuse1e4_noisy_s4) + geom_hline(yintercept = min(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"]) + 1.754834e-07)
plot_full_curve(ombc_reinit1e4reuse1e4_noisy_s4) + geom_vline(xintercept = 283)
sd(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"])
min(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"])
min(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"]) + sd(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"])
plot_full_curve(ombc_reinit1e4reuse1e4_noisy_s4) + geom_hline(xintercept = 0.0009)
plot_full_curve(ombc_reinit1e4reuse1e4_noisy_s4) + geom_hline(yintercept = 0.0009)
min(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"]) + sd(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"])
plot_full_curve(ombc_reinit1e4_noisy_s4) + geom_hline(yintercept = 0.0008738831)
acf(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"])
?acf
acf(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"], plot = F)
acf(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"], plot = F, type = "covariance")
acf(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"], plot = F, type = "covariance")[2]
acf(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"], plot = F, type = "covariance")[1]
plot_full_curve(ombc_reinit1e4_noisy_s4) + geom_hline(yintercept = min(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"]) + 1.3e-08)
plot_full_curve(ombc_reinit1e4_noisy_s4) + geom_hline(yintercept = min(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"]) + sqrt(1.3e-08))
sqrt(1.3e-08)
sd(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"])
sd(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"]) - srt(1.3e-08)
sd(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"]) - sqrt(1.3e-08)
mean(abs(diff(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"])))
plot_full_curve(ombc_reinit1e4_noisy_s4) + geom_hline(yintercept = min(ombc_reinit1e4_noisy_s4$distrib_diff_mat[, "full"]) + 9.526e-06
)
mean(abs(diff(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"])))
plot_full_curve(ombc_reinit1e4reuse1e4_noisy_s4) + geom_hline(yintercept = min(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"]) + 5.763548e-06)
ombc_update1e4_noisy_s1 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_update1e4_noisy_s1.rds")
plot_full_curve(ombc_update1e4_noisy_s1)
ombc_update1e4_noisy_s2 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_update1e4_noisy_s2.rds")
plot_full_curve(ombc_update1e4_noisy_s2)
ombc_reinit1e1_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_reinit1e1_noisy_s4.rds")
ombc_reinit1e1reuse1e4_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_reinit1e1reuse1e4_noisy_s4.rds")
plot_full_curve(ombc_reinit1e1_noisy_s4)
plot_full_curve(ombc_reinit1e1reuse1e4_noisy_s4)
plot_tail_curve(ombc_reinit1e1_noisy_s4)
plot_tail_curve(ombc_reinit1e1reuse0_noisy_s4)
plot_tail_curve(ombc_reinit1e1reuse1e4_noisy_s4)
lead(1:3)
lag(1:3)
1:3 < lag(1:3)
1:3 < lead(1:3)
stepback <- function(x, alpha) {
within_alpha <- x < lead(x) * (1 + alpha)
xmin <- which.min(x)
y <- xmin
keep_going <- TRUE
while(keep_going) {
if (within_alpha[y - 1]) {
y <- y - 1
keep_going <- TRUE
} else {
keep_going <- FALSE
}
}
return(y)
}
stepback(ombc_reinit1e1reuse1e4_noisy_s4$distrib_diff_mat[, "full"], 0.001)
ombc_reinit1e1reuse1e4_noisy_s4[55]
plot(ombc_reinit1e1reuse1e4_noisy_s4$distrib_diff_mat[, "full"])
which.min(ombc_reinit1e1reuse1e4_noisy_s4)
which.min(ombc_reinit1e1reuse1e4_noisy_s4$distrib_diff_mat[, "full"]
)
stepback <- function(x, alpha) {
within_alpha <- x < lead(x) * (1 + alpha)
y <- which.min(x)
keep_going <- TRUE
while(keep_going) {
if (within_alpha[y - 1]) {
y <- y - 1
keep_going <- TRUE
} else {
keep_going <- FALSE
}
}
original <- c(which.min(x), min(x))
retreated <- c(y, x[y])
return(y)
}
stepback(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"])
stepback(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"], 0.01)
plot(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"])
plot(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"], type = "l")
return(list("original" = original, "retreated" = retreated))
stepback <- function(x, alpha) {
within_alpha <- x < lead(x) * (1 + alpha)
y <- which.min(x)
keep_going <- TRUE
while(keep_going) {
if (within_alpha[y - 1]) {
y <- y - 1
keep_going <- TRUE
} else {
keep_going <- FALSE
}
}
original <- c(which.min(x), min(x))
retreated <- c(y, x[y])
return(list("original" = original, "retreated" = retreated))
}
stepback(ombc_reinit1e1reuse1e4_noisy_s4$distrib_diff_mat[, "full"], 0.001)
abline(v = 58)
abline(v = 55)
stepback(ombc_reinit1e1reuse1e4_noisy_s4$distrib_diff_mat[, "full"], 0.01)
stepback <- function(x, alpha) {
within_alpha <- x < lead(x) * (1 + alpha)
y <- which.min(x)
keep_going <- TRUE
while(keep_going & y > 1) {
if (within_alpha[y - 1]) {
y <- y - 1
keep_going <- TRUE
} else {
keep_going <- FALSE
}
}
original <- c(which.min(x), min(x))
retreated <- c(y, x[y])
return(list("original" = original, "retreated" = retreated))
}
stepback(ombc_reinit1e1reuse1e4_noisy_s4$distrib_diff_mat[, "full"], 0.01)
sum(ombc_reinit1e4reuse1e4_noisy_s4$gross_outs)
which.min(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"])
stepback(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"], 0.01)
plot(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"], type = "l")
abline(v = 67)
abline(v = 34)
stepback(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"], 0.001)
abline(h = 1.01 * 7.866299e-04)
plot(ombc_update1e4_noisy_s4$distrib_diff_mat[, "full"], type = "l")
plot(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"], type = "l")
stepback(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"], 0.001)
stepback(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"], 0.01)
abline(v = 20)
sum(ombc_update1e4_noisy_s1$gross_outs)
abline(h = 1.01 * 9.538559e-04)
abline(h = 1.1 * 9.538559e-04)
stepback(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"], 0.05)
stepback(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"], 0.005)
retreat <- function(x, alpha) {
xmin_val <- min(x)
xmin_ind <- which.min(x)
within_alpha <- x < lead(x) + alpha * xmin_val
y <- xmin_ind
keep_going <- TRUE
while(keep_going & y > 1) {
if (within_alpha[y - 1]) {
y <- y - 1
keep_going <- TRUE
} else {
keep_going <- FALSE
}
}
minimum <- list("ind" = xmin_ind, "val" = xmin_val)
retreat <- list("ind" = y, "val"= x[y])
return(list("minimum" = minimum, "retreat" = retreat))
}
retreat(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"], 0.001)
retreat(ombc_reinit1e4reuse1e4_noisy_s4$distrib_diff_mat[, "full"], 0.01)
retreat(ombc_update1e4_noisy_s4$distrib_diff_mat[, "full"], 0.01)
retreat(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"], 0.01)
plot(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"])
retreat(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"], 0.01)
abline(v = 23, h = 0.001165716)
sum(ombc_update1e4_noisy_s1$gross_outs)
plot(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"], type = "l")
abline(v = 23, h = 0.001165716)
?plot
?ylim
plot(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"], type = "l", xlim = c(0, NA))
plot(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"], type = "l", xlim = c(0, Inf))
plot(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"], type = "l", xlim = c(0, NULL))
plot(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"], type = "l", xlim = c(0))
plot(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"], type = "l", ylim = c(0))
plot(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"], type = "l", ylim = c(0, max(ombc_update1e4_noisy_s1$distrib_diff_mat[, "full"])))
abline(v = 23, h = 0.001165716)
retreat(ombc_update1e4_noisy_s2$distrib_diff_mat[, "full"], 0.01)
plot(ombc_update1e4_noisy_s2$distrib_diff_mat[, "full"], type = "l", ylim = c(0, max(ombc_update1e4_noisy_s2$distrib_diff_mat[, "full"])))
abline(v = 23, h = 0.001211773)
abline(v = 10, h = 0.001211773)
plot(ombc_update1e4_noisy_s2$distrib_diff_mat[, "full"], type = "l", ylim = c(0, max(ombc_update1e4_noisy_s2$distrib_diff_mat[, "full"])))
abline(v = 10, h = 0.001211773)
sum(ombc_update1e4_noisy_s2$gross_outs)
ombc_update1e3_noisy_s3 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_update1e3_noisy_s3.rds")
plot_full_curve(ombc_update1e4_noisy_s3)
retreat(ombc_update1e4_noisy_s3$distrib_diff_mat[, "full"], 0.01)
plot(ombc_update1e4_noisy_s3$distrib_diff_mat[, "full"], type = "l", ylim = c(0, max(ombc_update1e4_noisy_s3$distrib_diff_mat[, "full"])))
abline(v = 10, h = 0.001007424)
abline(v = 54, h = 0.001007424)
sum(ombc_update1e4_noisy_s3$gross_outs)
plot(ombc_update1e4_noisy_s3$distrib_diff_mat[, "full"], type = "l", ylim = c(0, max(ombc_update1e4_noisy_s3$distrib_diff_mat[, "full"])))
abline(v = 54, h = 0.001007424)
document()
library(devtools)
document()
document()
check()
check()
check()
lintr:::addin_lint_package()
lintr:::addin_lint_package()
lintr:::addin_lint_package()
lintr:::addin_lint_package()
styler:::style_active_pkg()
ombc_gmm_k3n1000o10 <- ombc_gmm(
gmm_k3n1000o10[, 1:2],
comp_num = 3, max_out = 20
)
load_all()
ombc_gmm_k3n1000o10 <- ombc_gmm(
gmm_k3n1000o10[, 1:2],
comp_num = 3, max_out = 20
)
dim(best_z[[3]])
dim(x0[!outlier_bool[, j], ])
sum(retreat_bool)
sum(outlier_bool[, 3])
sum(outlier_bool[, 2])
sum(outlier_bool[, 1])
retreat(distrib_diff_mat[, 1])
retreat(distrib_diff_mat[, 2])
load_all()
ombc_gmm_k3n1000o10 <- ombc_gmm(
gmm_k3n1000o10[, 1:2],
comp_num = 3, max_out = 20
)
ombc_gmm_k3n1000o10$outlier_num
gross_k3n1000o10 <- find_gross(gmm_k3n1000o10[, 1:2], 20)
gross_k3n1000o10$plot
ombc_k3n1000o10 <- ombc_gmm(
gmm_k3n1000o10[, 1:2], 3, 20,
gross_outs = gross_k3n1000o10$gross_bool,
print_interval = 10
)
plot_full_curve(ombc_k3n1000o10)
plot_retreat_curve(ombc_k3n1000o10)
load_all()
plot_retreat_curve(ombc_k3n1000o10)
gross_k3n2000o20 <- find_gross(gmm_k3n2000o20[, 1:2], 40)
gross_k3n2000o20$plot
ombc_k3n2000o20 <- ombc_gmm(
gmm_k3n2000o20[, 1:2], 3, 40,
gross_outs = gross_k3n2000o20$gross_bool,
print_interval = 10
)
plot_full_curve(ombc_k3n2000o20)
plot_tail_curve(ombc_k3n2000o20)
plot_retreat_curve(ombc_k3n2000o20)
gross_k3n4000o40 <- find_gross(gmm_k3n4000o40[, 1:2], 80)
gross_k3n4000o40$plot
ombc_k3n4000o40 <- ombc_gmm(
gmm_k3n4000o40[, 1:2], 3, 80,
gross_outs = gross_k3n4000o40$gross_bool,
print_interval = 10
)
plot_tail_curve(ombc_k3n4000o40)
plot_full_curve(ombc_k3n4000o40)
plot_retreat_curve(ombc_k3n4000o40)
document()
lintr:::addin_lint_package()
styler:::style_active_pkg()
ombc_reinit1e3reuse1e4_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_reinit1e3reuse1e4_noisy_s4.rds")
ombc_reinit1e3_noisy_s4 <- readRDS("C:/Users/Administrator/OneDrive - Trinity College Dublin/PhD/Programming/outlierMBC_demos/s_high_nmax/ombc_reinit1e3_noisy_s4.rds")
plot_full_curve(ombc_reinit1e3_noisy_s4)
plot_full_curve(ombc_reinit1e3reuse1e4_noisy_s4)
plot_tail_curve(ombc_reinit1e3reuse1e4_noisy_s4)
plot_tail_curve(ombc_reinit1e3_noisy_s4)
remotes::install_github("UltanPDoherty/outlierMBC")
outlierMBC::ombc_gmm()
outlierMBC::ombc_gmm
